<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Xinyu Li" />

<meta name="date" content="2023-12-03" />

<title>homework answers</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework answers</h1>
<h4 class="author">Xinyu Li</h4>
<h4 class="date">2023-12-03</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>This file contains all my homework answers in the class of statistcs
computing. Due to the limitation of space, some parts of it have been
slightly modified and omitted.</p>
</div>
<div id="hw0" class="section level2">
<h2>HW0</h2>
<div id="question" class="section level3">
<h3>Question</h3>
<p>Use knitr to produce at least 3 examples(texts, figures, tables).</p>
</div>
<div id="answers" class="section level3">
<h3>Answers</h3>
<div id="example1" class="section level4">
<h4>Example1</h4>
<p>This example reads the average wage data of the United States for a
period of time since 2000, the data is artificially labeled as a time
series, and the method of exponential smoothing is used for fitting.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(finalwork)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#loading </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(HW0data1)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(HW0data1)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#label time series</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>xt <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">t</span>(HW0data1), <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>,<span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">4</span>) </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(xt, <span class="at">main=</span><span class="st">&quot;The average income in USA&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;income&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#fit</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(xt)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y1)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(HW0data1)</span></code></pre></div>
</div>
<div id="example2" class="section level4">
<h4>Example2</h4>
<p>This example reads the weather data of Hefei, and then plots and
displays the minimum temperature of Hefei using the functions in the
ggplot2 package.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(finalwork)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(HW0data2)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(HW0data2)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.2.3</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code></pre></div>
<pre><code>## Warning: package &#39;lubridate&#39; was built under R version 4.2.3</code></pre>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     date, intersect, setdiff, union</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>data_time <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">day =</span> <span class="fu">ymd</span>(HW0data2[,<span class="dv">1</span>]), <span class="at">lowtemp =</span>HW0data2[,<span class="dv">3</span>])</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_time, <span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>lowtemp))<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">&quot;2 years&quot;</span>)<span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;The lowest temperature in Hefei&quot;</span>)<span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">30</span>,<span class="at">hjust=</span><span class="fl">0.8</span>,<span class="at">vjust=</span><span class="fl">0.8</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(HW0data2)</span></code></pre></div>
</div>
<div id="example3" class="section level4">
<h4>Example3</h4>
<p>This example models and constructs a time series of length 1000 for
the following AR sequence.</p>
<p><span class="math display">\[
x_t=1.4x_{t-1}-0.6x_{t-2}+\epsilon_t,\quad \epsilon_t \    i.i.d.\sim
\mathcal{N}(0,1)
\]</span></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(graphics)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fl">1.4</span>;b<span class="ot">&lt;-</span><span class="sc">-</span><span class="fl">0.6</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>AR2 <span class="ot">&lt;-</span> <span class="cf">function</span>(eps) {</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(eps))   <span class="co">#construct x</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="ot">=</span>eps[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]        <span class="co">#initialize</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="fu">length</span>(eps)) {  <span class="co">#xt construct</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    x[t]<span class="ot">=</span>a<span class="sc">*</span>x[t<span class="dv">-1</span>]<span class="sc">+</span>b<span class="sc">*</span>x[t<span class="dv">-2</span>]<span class="sc">+</span>eps[t]</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">#set seed and generate series</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>epsi <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>Xt<span class="ot">&lt;-</span> <span class="fu">AR2</span>(epsi)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Xt, <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;time&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">main=</span><span class="fu">expression</span>(X[t]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="hw1" class="section level2">
<h2>HW1</h2>
<div id="question-1" class="section level3">
<h3>Question</h3>
<ul>
<li><p>Use the inverse transform to replicate part of sample
(replace=TRUE) in a function named my.sample.</p></li>
<li><p>Exercises 3.2, 3.7, 3.9, 3.10 (pages 94-96, Statistical Computing
with R).</p></li>
</ul>
</div>
<div id="answers-1" class="section level3">
<h3>Answers</h3>
<div id="exercise1" class="section level4">
<h4>Exercise1</h4>
<p>Refer to the courseware example, define <span class="math inline">\(x\)</span> as sampling sample, <span class="math inline">\(prob\)</span> as sampling probability, and the
default value is equal probability sampling.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>my.sample<span class="ot">&lt;-</span><span class="cf">function</span>(x,size,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(x),<span class="fu">length</span>(x))){</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#size is the number of samples taken, and prob is the probability of sampling weight</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  cp<span class="ot">&lt;-</span><span class="fu">cumsum</span>(prob)      <span class="co">#Divide the probability 1 interval from 0 to 1</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  U<span class="ot">&lt;-</span><span class="fu">runif</span>(size)        </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  r<span class="ot">&lt;-</span>x[<span class="fu">findInterval</span>(U,cp)<span class="sc">+</span><span class="dv">1</span>]    <span class="co">#Find the subscript of x corresponding to the interval of cp where u is, and then extract x</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r)      <span class="co">#Return the number of samples</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">10</span>),<span class="at">size=</span><span class="dv">10</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>my.s<span class="ot">&lt;-</span><span class="fu">my.sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">10</span>),<span class="at">size=</span><span class="dv">10</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(s)</span></code></pre></div>
<pre><code>##  [1]  2  1  1 10 10  4  4  1 10 10</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my.s)</span></code></pre></div>
<pre><code>##  [1]  1 10 10  1  2  2  2  4  4  2</code></pre>
</div>
<div id="exercise-3.2" class="section level4">
<h4>Exercise 3.2</h4>
<p>From <span class="math inline">\(f(x)\)</span>, when <span class="math inline">\(x&gt;0\)</span>, we have <span class="math inline">\(F(x)=1-\frac 1 2e^{-x}\)</span>, which means <span class="math inline">\(X=F_X^{-1}(U)=-log(2-2U),U\in (1/2,1)\)</span>.
When <span class="math inline">\(x&lt;=0\)</span>, we have <span class="math inline">\(F(x)=\frac 1 2e^{x}\)</span>, which means <span class="math inline">\(X=F_X^{-1}(U)=log(-2U),U\in
(0,1/2]\)</span>.<br />
According to the algorithm, 1000 random numbers obey the standard
uniform distribution, and then <span class="math inline">\(X\)</span>is
obtained by dividing <span class="math inline">\(u&gt;1/2\)</span> and
<span class="math inline">\(u&lt;=1/2\)</span> using the above
distribution function. Note: In the title of the image generated by the
code, <span class="math inline">\(x\)</span> represents <span class="math inline">\(|x|\)</span> because it is not good to output the
absolute value sign of latex.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(graphics)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2023</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span>    <span class="co">#number of random variables</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)  <span class="co">#generate u</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(u))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">which</span>(u<span class="sc">&lt;=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)]<span class="ot">&lt;-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>u[<span class="fu">which</span>(u<span class="sc">&lt;=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)])   <span class="co">#find u &lt;=1/2</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">which</span>(u<span class="sc">&gt;</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)]<span class="ot">&lt;-</span><span class="sc">-</span><span class="fu">log</span>(<span class="dv">2-2</span><span class="sc">*</span>u[<span class="fu">which</span>(u<span class="sc">&gt;</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)]) </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">#find u &gt;1/2</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">#histogram plot</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x}),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>))</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="fl">0.05</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(y)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3.7" class="section level4">
<h4>Exercise 3.7</h4>
<p><span class="math inline">\(f(x)=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}x^{a-1}(1-x)^{b-1}\)</span>,
take the derivative and get <span class="math inline">\(x_0=argmax_{x
\in (0,1)}f(x)=\frac{a-1}{a+b-2}\)</span>(here we consider <span class="math inline">\(a&gt;=2\)</span>), then we choose <span class="math inline">\(g(x)=1,0&lt;x&lt;1\)</span> and <span class="math inline">\(c=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}x_0^{a-1}(1-x_0)^{b-1}\)</span>.
Algorithm：<br />
1.generate <span class="math inline">\(U\sim U(0,1)\)</span> and <span class="math inline">\(Y \sim U(0,1)\)</span>,<br />
2.If <span class="math inline">\(U\leq \frac{f(Y)}{cg(Y)}\)</span>,
accept <span class="math inline">\(Y\)</span>, otherwise reject and
continue.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(graphics)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2023</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>generate_beta<span class="ot">&lt;-</span><span class="cf">function</span>(n,a,b){</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#a,b~Beta(a,b)</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  j<span class="ot">&lt;-</span>k<span class="ot">&lt;-</span><span class="dv">0</span>;y<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  x0<span class="ot">&lt;-</span>(a<span class="dv">-1</span>)<span class="sc">/</span>(a<span class="sc">+</span>b<span class="dv">-2</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  c<span class="ot">&lt;-</span>x0<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x0)<span class="sc">^</span>(b<span class="dv">-1</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(k<span class="sc">&lt;</span>n){</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    u<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    j<span class="ot">&lt;-</span>j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>)<span class="sc">/</span>c<span class="sc">&gt;</span>u){  <span class="co">#accept x</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>      k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span>;y[k]<span class="ot">&lt;-</span>x</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">generate_beta</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co">#histogram plot</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&#39;Beta(&#39;</span>,<span class="dv">3</span>,<span class="st">&#39;,&#39;</span>,<span class="dv">2</span>,<span class="st">&#39;)&#39;</span>))</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, y<span class="sc">^</span>(<span class="dv">3-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">^</span>(<span class="dv">2-1</span>)<span class="sc">*</span><span class="fu">gamma</span>(<span class="dv">3</span><span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">gamma</span>(<span class="dv">3</span>)<span class="sc">/</span><span class="fu">gamma</span>(<span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3.9" class="section level4">
<h4>Exercise 3.9</h4>
<p>According to the above algorithm, <span class="math inline">\(U_1,U_2,U_3\)</span>are generated and selected
according to the size.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(graphics)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2023</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">3</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)   <span class="co">#generate u1,u2,u3</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(u[<span class="dv">3</span>])<span class="sc">&gt;=</span><span class="fu">abs</span>(u[<span class="dv">2</span>]) <span class="sc">&amp;</span> <span class="fu">abs</span>(u[<span class="dv">3</span>])<span class="sc">&gt;=</span><span class="fu">abs</span>(u[<span class="dv">1</span>])) x[i]<span class="ot">&lt;-</span>u[<span class="dv">2</span>]</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> x[i]<span class="ot">&lt;-</span>u[<span class="dv">3</span>]</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">#histogram plot</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAllBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6ZrY6kNtmAABmADpmOgBmOjpmOmZmZmZmkLZmtv+QOgCQOjqQZjqQkGaQkLaQtv+Q2/+2ZgC2kGa2kJC227a22/+2/7a2///T09PbkDrbtpDb25Db/9vb////tmb/tpD/25D/27b//7b//9v///8jv/sNAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKm0lEQVR4nO2diXbbNhBF4bS226aN0iVxuoRdzbZmFUn//3MliUUARfBhJSBq3jm2ZQkcDK7AwUIQZCfSolhpB2oXAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQECbBrR/ZOx9pI3qAUU4eNi9P3V3H4vlv44iHOzuX07Hp8gqtGVAg4ZaVDJ/Zx1/+0W9/u/di/Nxc/7ptpDa+xef7NwcyKBP3/+h/bf//i/XA2f8M20tq331l1d2Tg6k1OHbsR05fGeGyv2XNpePPzJ2p33lZ/860SCdbeHTp+Uh2p4dVmZATV/cj32kfDN5v6/5s+kHoL0e1BvKv77JHnGcbfVpAaCx/ixl56C8gI5Po4vtRVu7f5wi42rZNy+nT9+q9Mq945Po0ihbf8NOzv4LacaWnYNyAxq+usPu4gsU5ObT95hkyZV77d1P45vS1vED+/wnAKgZa+N7e3Yuygqo46dLx08Z/qfhpWoWCvfPThVHutcHIB6DhK3T4e27l27ehpGP0FJ2y1oDUMN4BR+8lAVstThjqmXsXjVTwr3D7kEEaWmLm58vtZ6PMmrLDmmFU6wPH6L92b36XVaOjtniZvOaqc+kd01/1IhD2eI25gHp+aikoWF6BUCHnSxIy76SLzvGS8DjhNFwad83k/+/FzjOtk52QHo+KmloEFoVUP/9Sw6LHquYyr3jbZAHIC0fl+wWtSqg/pX0c9njxgDUylp293Ee0LQaavmopBUDOseNhv0gyyCDglk20YgfRARRZ5gC5BSD9HxU0opjkGp5urFF44WyNCvN2FF8EgcYzrm3Yno+QlW3YrLJHevF/pF/le184fqTY5D4umcA6c23BZCRj5AlOwet2JPmX2o7VgFr19YYrM4A0nvlFkB6PsqPOnvSUu5jMUOzvl3aclC1YzGh49M0AjgNr2d9u7TloGpH81IX80Ffu9T4ed+mthzklp2PE8l1/KCXymdOENlyUFR2q81J/6rNSf8cM0ls2nJQXHbVX9UoLQIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIE5AeoYexhWAwXvcD/euQFaLh60gyXNg+74OtM1yYfQOMCU37zQ8SFpiuTD6BxXXI3XsTtgi/lXpuoBgGFxaDLleGbFbViQNQPAiJAQIGAWmrF/KwoJTFXkxKXKKk5NlVK485OVGyOPXOpvymNOzvhlXps4ntZI9CNA1IrRztm6SjeNiCt/2wbatw2IO0mWttg9bYBrV+D9CbsCgCdF/SvEYM4lHMNKtTO++UpbqWw3zqTqggjjctTrACjKvtBAsNsDFqbUYWAFAFLkF6XUH2AziYuAMkRx5qIagM0lF1ruExAJqd1KFUGiIeZeTDPeqPW07tBQLbgPANoQJTCYexTPebswXkW0EqEagB0Me/jCmiNWFQFIBlUlsFcAJLhKG0Rps5VYI6JUvsD4j9pizB1rgJzbKw/QYDyt2Z1AGIuYGYBPd8EoNmSOwLK3ZhVAcgNjAVQZkJFAbk16xBQ1svDZQGJILJ9QIHX9kTTFQ0oJyFl+rAL3kFmzpxbaq/+jz0G5exRa1aHfYxi10X5AvLp/1gBiV/ZAZ0SMPIN0j5gFgFl6w9NrbZLF5b9zVlSmc1XEkC5WnvDajcurhP7hcabs6dyKrEnoOw1aLikw8lErPH1ApS2BmWqQlorFrs9vmFuOZUo2HUBesv5xC0R9wDEcIk9AWXpDl0Ailt96A6IOZTYF1AOQsJkc+4Lr9DMZwOUgdBFDUpkbjnVuXd3PYDWNJcJUJYhRyFAzKnEnoDErxyADrs3cmVLTD/avSftXmJPQMmHHGVqUEZAqbtDIdb2j9abfYoONeTfgCIt+KpeDfehtguLx87ryxZORCfnpnOsVwKouX/ZPz6cmoVpM7E0MbIGXaytSw0o7UpS+WJ8WtnwvIWlIM03K44DxLKfYvkADVvJg6FG0w9paweUtOXRTrGHoX4Mj/hYVMveVA8o6Wpk9aoPwcOm+nDmfv/4WQygcUCQG1BCQgGWjCcT+JqbW2O3NUAx5mbX2F0JIHgvmC5bKF92zLKELEc/KBkhLUjHXMxwG0lb1rlk6SimIqQ18yk2U0A1KKzEIYBSETL6QQnNzX8aWGLP5EmnhZQZp8cxRN6zuhIg8ccHw4LP6pX1UUJnRd6zar23IA+gRAtX5AuHCbPIOw5nbgDLCihNFPIxEnnP6vYBBdcgsIQ+WwxKQUiz0Z9k9y/NUmMfes8qE36vHqQTENKC9N3HdhjNLxEKvGeVCbevGtBw/gwnTo5Lz2UApekPGR3FAVCOxQvy7FoXkPiVCpCsQU3U/nY2QCxBiQsDEjEo/GGAE3PGu8UAPUdfRzRbsfHp8InM6e+WAxTdoV5lwgystSNAmwDEuzixO5AudBQLAUoVg8STbdvItfaz3jjfpVsxoE4G54VrXh7mJm+WBRRHiB+tzZYtXZt3NTd98/oBaSOwDEON0qdYFCEJCM70+Jibvlc6BsUQyg/o8lo8AVL/ud2UesOAhJ+lAcUQkoDg4rplK/OTL0y4ef2AkqlSQBHFJEBeJYpWjYDipl4zA2IJSxwKSHJKUaJoTZv5lCUmQDcIKGmJCVBWQKHzQgTIq0TRqhlQWFFzAnLdOWmtGhRU1oyA4DwQASJAS+bwRBkBqgxQUGH9jvFYBjxOw9waIJ9lwDUCCiHkc4jzIk7HuejNAXJeBsyEX3UBCpsXylODhFt1ARK/MgJyXgZcL6Bn7xVnfskdlwFH7X981YAczREgBChFUa4b0PI9qxUD8p71SFODJldWWdUqAWjDIkBAiQer21Piwer2lHioIYxWrXyAnJdZuRp1TFckWUhy9xqUNvOrAeQwWPUzujlAeLDqZ3R7gBIbJUBp0hGgGpMFJk9rlAClSbc9QFsSAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAaUGtP9SXe7oIvezMo63G9M/4VPClt1HwlxLDOiwU9eDhg1lughCxvF2Y8Yn+y/s+QW6lhZQd74qza8Rhe8lYxxvN2Z+snC5LtS1pIA69ka5yDciCt9Lxjjebsz8pLUWOti11DHo7MVY28M3ujCOtxszP2leM/tDGsNcywaIn+PhQcg43m7M+IQ/esi2X2+Ya5sCNHEhiWvbOsX4W5Zt2IqeYuo57GWDNH/L0tZXFqRLNPO85PAUK9fM614U6SiOhYZBumBHUXjBdx1sI4ca4nhkzEg2PJLZthFkmGs0WAUiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIEVDugYR2Y9ojK9VU7IPmU92KqHdCpe/Xn27gnmMepekCnxnZzyjqqH1BnXVO3iqoHdHz6oeiujdUDau//fSq5aWPtgIatCeMe/Rqp2gE1fROvPct8fdUOqLgIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgT0P3zO9HYWiu+/AAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="exercise-3.10" class="section level4">
<h4>Exercise 3.10</h4>
<p>Suppose the sample extracted by the algorithm is <span class="math inline">\(X\)</span>, then the algorithm knows that the
value of <span class="math inline">\(X\)</span>is <span class="math inline">\([-1,1]\)</span> and its distribution is symmetric
(according to the conditional judgment statement when taking <span class="math inline">\(X\)</span>). Then we have <span class="math inline">\(P(|X| \leq x)=2P(X\leq x),x\in [0,1]\)</span>
and</p>
<p><span class="math display">\[
\begin{aligned}\small
&amp;P(|X|\leq x)\\
&amp;=P(max(|U_1|,|U_2|)\leq |U_3|,|U_2|\leq x)+P(max(|U_1|,|U_2|)&gt;
|U_3|,|U_3|\leq x)   \\
&amp;=P(|U_1|\leq|U_2|\leq |U_3|,|U_2|\leq x)+P(|U_2|\leq|U_1|\leq
|U_3|,|U_2|\leq x)+P(max(|U_1|,|U_2|)&gt; |U_3|,|U_3|\leq x)   \\
&amp;=\int_0^xdu_2 \int_0^{u_2}2\cdot \frac 1 2du_1 \int_{u_2}^1
2\cdot\frac 1 2du_3+\int_0^xdu_2 \int_{u_2}^{1}2\cdot \frac 1 2du_1
\int_{u_1}^1 2\cdot\frac 1 2du_3 +P(|U_1|&gt; |U_3|,|U_3|\leq x)^2  \\
&amp;=\int_0^x du_2
[\int_0^{u_2}(1-u_2)du_1+\int_{u_2}^1(1-u_1)du_1]+\int_0^x 2 \cdot\frac
1 2(1-u_2^2)du_3  \\
&amp;=\frac{3x-x^3}{2}
\end{aligned}
\]</span> where <span class="math inline">\(\frac 1 2\)</span> is <span class="math inline">\(U_k\)</span> p.d.f.. So<span class="math inline">\(P(X\leq x)=\frac{3x-x^3}{4}\)</span>. This is also
the distribution function corresponding to <span class="math inline">\(f_e(x)\)</span>, indicating that the random sample
extracted by the algorithm does satisfy the density distribution of
<span class="math inline">\(f_e(x)\)</span>.</p>
</div>
</div>
</div>
<div id="hw2" class="section level2">
<h2>HW2</h2>
<div id="question-2" class="section level3">
<h3>Question</h3>
<ul>
<li>Ex1
<ul>
<li><p>Proof that what value <span class="math inline">\(\rho=l/d\)</span> should take to minimize the
asymptotic variance of <span class="math inline">\(\hat \pi\)</span>
(m~B(n,p),using <span class="math inline">\(\delta\)</span>
method)</p></li>
<li><p>Take three different values of <span class="math inline">\(\rho\)</span> (<span class="math inline">\(0 \leq
\rho \leq 1\)</span>, including <span class="math inline">\(\rho_{min}\)</span>) and use Monte Carlo
simulation to verify your answer. (n = <span class="math inline">\(10^6\)</span>, Number of repeated simulations K =
100)</p></li>
</ul></li>
<li>Ex2
<ul>
<li>Exercises 5.6, 5.7 (pages 149-151, Statistical Computing with
R)</li>
</ul></li>
</ul>
</div>
<div id="answers-2" class="section level3">
<h3>Answers</h3>
<div id="ex1" class="section level4">
<h4>Ex1</h4>
<p>According to the calculation of the pdf., we have <span class="math inline">\(\hat p=\frac{m}{n}=\frac{2\rho}{\hat \pi}\)</span>
(note that here the definition of <span class="math inline">\(\hat
p\)</span> and pdf are opposite), namely <span class="math display">\[\hat \pi=\frac{2\rho}{\hat p}\]</span>. According
to the binomial distribution and the central limit theorem we have <span class="math inline">\(\sqrt{n}(\hat p-p)\rightarrow
N(0,p(1-p))\)</span>$, and then according to the delta method we
have</p>
<p><span class="math display">\[
\sqrt{n}(\hat \pi-\pi) \rightarrow N(0,p(1-p)4\rho^2/p^4)
\]</span> where define <span class="math inline">\(g(p)=2\rho/p\)</span>, take the derivation and get
the above equation. Then we use the definition of <span class="math inline">\(p\)</span> to obtain <span class="math inline">\(p=2\rho/ \pi\)</span>, <span class="math display">\[
\sqrt{n}(\hat \pi-\pi) \rightarrow N(0,\pi^2(1-p)/p),
\]</span></p>
<p>as <span class="math inline">\(0 \leq \rho \leq 1\)</span>, due to
<span class="math inline">\(2\rho/p = \pi\)</span>, we have the
asymptotic variance is minimum when <span class="math inline">\(\rho=1\)</span>.</p>
<ol start="2" style="list-style-type: decimal">
<li>Take <span class="math inline">\(\rho_1=0.3,\rho_2=0.7,\rho_3=1,d=1\)</span>.</li>
</ol>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#set rho</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>rho1<span class="ot">=</span><span class="fl">0.3</span>;rho2<span class="ot">=</span><span class="fl">0.7</span>;rho3<span class="ot">=</span><span class="dv">1</span>;d<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">#set n and K</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span>;K<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>pihat1<span class="ot">&lt;-</span><span class="fu">numeric</span>(K);pihat2<span class="ot">&lt;-</span><span class="fu">numeric</span>(K);pihat3<span class="ot">&lt;-</span><span class="fu">numeric</span>(K)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">#MC simulation</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#calculate pihat</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  pihat1[k]<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">*</span>rho1<span class="sc">/</span><span class="fu">mean</span>(rho1<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  pihat2[k]<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">*</span>rho2<span class="sc">/</span><span class="fu">mean</span>(rho2<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  pihat3[k]<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">*</span>rho3<span class="sc">/</span><span class="fu">mean</span>(rho3<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>pihat1_MC<span class="ot">&lt;-</span><span class="fu">mean</span>(pihat1)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>pihat2_MC<span class="ot">&lt;-</span><span class="fu">mean</span>(pihat2)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>pihat3_MC<span class="ot">&lt;-</span><span class="fu">mean</span>(pihat3)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>var<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate var(pihat)</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>var[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">var</span>(pihat1);var[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">var</span>(pihat2);var[<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">var</span>(pihat3)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>var</span></code></pre></div>
<pre><code>## [1] 5.299701e-05 1.224245e-05 6.612878e-06</code></pre>
<p>According to the calculated variance, it can be found that the
variance when <span class="math inline">\(\rho=1\)</span>is the
smallest, which accords with the theoretical result of the first
question, and it can also be seen from the first question that the
asymptotic variance will decrease with the increase of <span class="math inline">\(\rho\)</span>, which is also explained by the MC
experiment.</p>
</div>
<div id="exercise-5.6" class="section level4">
<h4>Exercise 5.6</h4>
<p><span class="math display">\[
\begin{aligned}
Cov(e^U,e^{1-U})&amp;=E[e^Ue^{1-U}]-E[e^U]E[e^{1-U}]=e-\int_0^1e^x\cdot1dx
\int_0^1e^{1-x}\cdot1dx \\
&amp;=e-(e-1)^2=-0.2342106   \\
Var(e^U+e^{1-U})&amp;=Var(e^U)+Var(e^{1-U})+2Cov(e^U,e^{1-U})\\
&amp;=-e^2+4e-3+2e-2(e-1)^2=0.01564999
\end{aligned}
\]</span></p>
<p>According to simple MC sample, we have the estimator of <span class="math inline">\(\theta\)</span> is <span class="math inline">\(\hat \theta_1=1/n\sum_{i=1}^ne^{U_i}\)</span>,
<span class="math inline">\(U_i \quad i.i.d.~U(0,1)\)</span>, while use
dual MC sample we have the estimator of <span class="math inline">\(\theta\)</span> is <span class="math inline">\(\hat
\theta_2=1/n\sum_{i=1}^n(e^{U_i}+e^{1-U_i})/2\)</span>, <span class="math inline">\(U_i \quad i.i.d.~U(0,1)\)</span>. Use the
assumption of <span class="math inline">\(i.i.d.\)</span>, we have</p>
<p><span class="math display">\[
\begin{aligned}
Var(\hat \theta_1)&amp;=\frac1 n
Var(e^U)=[-1/2e^2+2e-3/2]/n=0.2420356/n  \\
Var(\hat \theta_2)&amp;=\frac 1 {4n}Var(e^U+e^{1-U})=0.01564999/(4n)
\end{aligned}
\]</span></p>
<p>So the variance decreases by a ratio of <span class="math inline">\(\frac{Var(\hat \theta_1)-Var(\hat
\theta_2)}{Var(\hat \theta_1)}=98.38\%\)</span>.</p>
</div>
<div id="exercise-5.7" class="section level4">
<h4>Exercise 5.7</h4>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">1</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">#MC</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>theta_hat1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(x))</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>theta_hat2<span class="ot">&lt;-</span><span class="fu">mean</span>((<span class="fu">exp</span>(x)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">#theta_hat</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>theta_hat1</span></code></pre></div>
<pre><code>## [1] 1.718614</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>theta_hat2</span></code></pre></div>
<pre><code>## [1] 1.717492</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#var(theta_hat)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">exp</span>(x))                   </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> <span class="fu">var</span>((<span class="fu">exp</span>(x)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x))<span class="sc">/</span><span class="dv">2</span>)      </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">#reduction ratio</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span>(var1<span class="sc">-</span>var2)<span class="sc">/</span>var1</span></code></pre></div>
<pre><code>## [1] 98.37736</code></pre>
</div>
</div>
</div>
<div id="hw3" class="section level2">
<h2>HW3</h2>
<div id="question-3" class="section level3">
<h3>Question</h3>
<ul>
<li><p>Ex1(see figure in the pdf in qq)</p></li>
<li><p>Ex2</p>
<ul>
<li><p>Exercises 5.13, 5.14, 5.15 (pages 149-151, Statistical Computing
with R) Computing with R)</p></li>
<li><p>Exercises 6.5, 6.A (pages 180-181, Statistical Computing with
R).</p></li>
</ul></li>
</ul>
</div>
<div id="answers-3" class="section level3">
<h3>Answers</h3>
<div id="ex1-1" class="section level4">
<h4>Ex1</h4>
<p>Here <span class="math inline">\(Var(\theta_I)\)</span> misses <span class="math inline">\(1/M\)</span>. We just need to proof <span class="math inline">\(\frac{1}{M} Var(\theta_I)\rightarrow
Var(\hat\theta_M)=\frac{1}{M}Var(g(U))\)</span>, i.e. <span class="math display">\[
lim_{k \rightarrow \infty} \sum_{i=1}^k\int_{a_i}^{b_i}
g_0^2(U)=\int_a^b g^2(U)
\]</span> where <span class="math inline">\(g_0(U)\)</span> is the step
function generated by <span class="math inline">\(g\)</span> on the
interval. According to the approximation theory of step function in real
analysis, the above formula is valid.</p>
</div>
<div id="exercise-5.13" class="section level4">
<h4>Exercise 5.13</h4>
<p>We choose<br />
<span class="math display">\[
\begin{aligned}
f_1(x)&amp;=\frac{1}{\sqrt{2\pi}}e^{-x^2/2},\\
f_2(x)&amp;=\frac{1}{2}x^2e^{-x}.
\end{aligned}
\]</span></p>
<p>in factr, <span class="math inline">\(f_1\)</span> follows <span class="math inline">\(N(0,1)\)</span>, <span class="math inline">\(f_2\)</span> follows <span class="math inline">\(\Gamma(3,1)\)</span>, the function form is close
to <span class="math inline">\(g(x)\)</span> and easy to sample.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="do">##define function</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x) <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="cf">function</span>(x) <span class="fu">dnorm</span>(x)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="cf">function</span>(x) <span class="fu">dgamma</span>(x,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="do">##sample</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> se<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>fg<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>m,<span class="at">ncol=</span><span class="dv">2</span>)  <span class="co">#m*2, Column i stores the f/g value generated by fi</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="do">###use f1</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>fg[,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">1</span>] <span class="ot">&lt;-</span><span class="fu">mean</span>(fg[,<span class="dv">1</span>])</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg[,<span class="dv">1</span>])</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="do">###use f2</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(m,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>fg[,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f2</span>(x)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">2</span>] <span class="ot">&lt;-</span><span class="fu">mean</span>(fg[,<span class="dv">2</span>])</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg[,<span class="dv">2</span>])</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="do">##show results</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(theta.hat, se)</span></code></pre></div>
<pre><code>##                [,1]      [,2]
## theta.hat 0.3976099 0.4002129
## se        1.1382376 0.4546994</code></pre>
<p>According to the results, the estimated standard deviation of <span class="math inline">\(f_2\)</span>is smaller. I think this result is
caused by the difference in the intersection range of the support
domains of the two importance functions and the support domains of <span class="math inline">\(g\)</span>: For a normal distribution, <span class="math inline">\(x\)</span> is all real numbers, but the support
domain of <span class="math inline">\(g\)</span> is <span class="math inline">\((1,\infty)\)</span>, so that <span class="math inline">\(g(x)/f(x)\)</span> has many zero values (more than
75%), and other non-zero values and near-zero means cause large
variance; However, the proportion of <span class="math inline">\(g(x)/f(x)\)</span> being zero for the gamma
distribution is smaller (less than 25%), so it performs better than
<span class="math inline">\(f_1\)</span>. The following code helps
illustrate this conclusion.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fg[,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.0000  0.0000  0.0000  0.3976  0.0000 14.8053</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fg[,<span class="dv">2</span>])</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## 0.000000 0.002832 0.172631 0.400213 0.776809 1.315489</code></pre>
</div>
<div id="exercise-5.14" class="section level4">
<h4>Exercise 5.14</h4>
<p>Choose <span class="math inline">\(f_2\)</span> as an importance
sampling function, the following code generates an MC estimate.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x) <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="cf">function</span>(x) <span class="fu">dnorm</span>(x)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>f2<span class="ot">&lt;-</span><span class="cf">function</span>(x) <span class="fu">dgamma</span>(x,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="do">##sample</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>fg<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="do">###use f2</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(m,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>fg<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f2</span>(x)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="do">##MC estimate</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>theta.hat</span></code></pre></div>
<pre><code>## [1] 0.4015777</code></pre>
</div>
<div id="exercise-5.15" class="section level4">
<h4>Exercise 5.15</h4>
<p>We need to estimate <span class="math inline">\(\theta=\int_0^1\frac{e^{-x}}{1+x^2}dx\)</span>,
and we choose <span class="math inline">\(f_3(x)=e^{-x}/(1-e^{-1}),0&lt;x&lt;1\)</span> as
an importance sampling function. Here the inverse transformation method
is used to generate a random number with a distribution of <span class="math inline">\(f_3\)</span>.</p>
<p>According to the question, the sampling interval was divided into 5
segments, i.e. <span class="math inline">\((F^{-1}((j-1)/5),F^{-1}(j/5)),j=1,\dots,5\)</span>.
In the jth interval, the variable is generated based on <span class="math display">\[5\frac{e^{-x}}{1-e^{-1}},(F^{-1}((j-1)/5)&lt;x&lt;
F^{-1}(j/5))\]</span>, where <span class="math inline">\(F^{-1}(t)=-log(1-x(1-e^{-1}))\)</span> is chosen
as the importance sampling function.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span>m<span class="sc">/</span>k  <span class="co">#Number of repetitions per interval</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> var.hat <span class="ot">&lt;-</span><span class="fu">numeric</span>(k)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>,i<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>u)  <span class="co">#generate x</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span>k<span class="sc">/</span><span class="fu">f</span>(x)   <span class="co">#gj/fj</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  theta.hat[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)   <span class="co">#estimate</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  var.hat[i]<span class="ot">&lt;-</span><span class="fu">var</span>(fg)</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(theta.hat)</span></code></pre></div>
<pre><code>## [1] 0.5250139</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">sum</span>(var.hat))</span></code></pre></div>
<pre><code>## [1] 0.0092304</code></pre>
<p>In 5.10, <span class="math inline">\(\hat\theta=0.5257801,se(\hat\theta)=0.0970314\)</span>.
The estimates are similar but the variance is much larger than the
result of 5.13.</p>
</div>
<div id="exercise-6.5" class="section level4">
<h4>Exercise 6.5</h4>
<p>Use the following equation to construct t-CI: <span class="math display">\[
\frac{\bar{X} -\mu}{\sqrt{S^2/n}}\sim t_{n-1}
\]</span> where <span class="math inline">\(S\)</span> is the sample
variance.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># set parameters</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># number of simulation</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">20</span>       </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>cl<span class="ot">&lt;-</span> <span class="fl">0.95</span>  <span class="co"># 1-alpha</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>coverage <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co"># MC</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate samples</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(sample_size, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate mean and sd</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  sample_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample_data)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  sample_se<span class="ot">&lt;-</span><span class="fu">sd</span>(sample_data) <span class="sc">/</span> <span class="fu">sqrt</span>(sample_size)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># t-interval</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  t_value <span class="ot">&lt;-</span> <span class="fu">qt</span>((<span class="dv">1</span> <span class="sc">-</span> cl) <span class="sc">/</span> <span class="dv">2</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>,<span class="at">df =</span> sample_size <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  lower_bound <span class="ot">&lt;-</span> sample_mean <span class="sc">-</span> t_value <span class="sc">*</span> sample_se</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  upper_bound <span class="ot">&lt;-</span> sample_mean <span class="sc">+</span> t_value <span class="sc">*</span> sample_se</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># test</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  true_mean_covered <span class="ot">&lt;-</span> (lower_bound <span class="sc">&lt;=</span> <span class="dv">2</span>) <span class="sc">&amp;</span> (upper_bound <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># reserve results</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>  coverage[i] <span class="ot">&lt;-</span> true_mean_covered</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="co"># prob</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>coverage_probability <span class="ot">&lt;-</span> <span class="fu">mean</span>(coverage)</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>coverage_probability</span></code></pre></div>
<pre><code>## [1] 0.9232</code></pre>
<p>This result is similar to that in Example 6.4, where the coverage
probability is approximately 0.95, but if the data is strictly followed
by a normal distribution, the estimate of the mean can be closer to
0.95. This result shows that the mean estimation is closer to the
confidence coefficient when the data does not follow the normal
distribution, which is more robust than the variance estimation.</p>
</div>
<div id="exercise-6.a" class="section level4">
<h4>Exercise 6.A</h4>
<p>The first type of error probability of the test is given in three
cases.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="do">##chi2</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span>  </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">30</span>       </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span> <span class="fl">0.05</span>  </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>mu0<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(sample_size, <span class="at">df =</span> <span class="dv">1</span>)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x,  <span class="at">mu =</span> mu0)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  p1[j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  t_stat <span class="ot">&lt;-</span> (<span class="fu">mean</span>(x) <span class="sc">-</span> mu0) <span class="sc">/</span> (<span class="fu">sd</span>(x) <span class="sc">/</span> <span class="fu">sqrt</span>(sample_size))</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  p2[j]<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">abs</span>(t_stat)<span class="sc">&gt;</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>sample_size<span class="dv">-1</span>))</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>p1.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(p1 <span class="sc">&lt;</span> alpha)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>p2.hat<span class="ot">&lt;-</span><span class="fu">mean</span>(p2)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p1.hat, p2.hat))</span></code></pre></div>
<pre><code>## [1] 0.0874 0.0874</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="do">##uniform</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span>  </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">30</span>      </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span> <span class="fl">0.05</span> </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>mu0<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(sample_size, <span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x,  <span class="at">mu =</span> mu0)</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  p1[j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  t_stat <span class="ot">&lt;-</span> (<span class="fu">mean</span>(x) <span class="sc">-</span> mu0) <span class="sc">/</span> (<span class="fu">sd</span>(x) <span class="sc">/</span> <span class="fu">sqrt</span>(sample_size))</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  p2[j]<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">abs</span>(t_stat)<span class="sc">&gt;</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>sample_size<span class="dv">-1</span>))</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>p1.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(p1 <span class="sc">&lt;</span> alpha)</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>p2.hat<span class="ot">&lt;-</span><span class="fu">mean</span>(p2)</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p1.hat, p2.hat))</span></code></pre></div>
<pre><code>## [1] 0.0501 0.0501</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="do">##exp</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span>  </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">30</span>       </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span> <span class="fl">0.05</span>  </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>mu0<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(sample_size, <span class="dv">1</span>)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x,  <span class="at">mu =</span> mu0)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  p1[j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  t_stat <span class="ot">&lt;-</span> (<span class="fu">mean</span>(x) <span class="sc">-</span> mu0) <span class="sc">/</span> (<span class="fu">sd</span>(x) <span class="sc">/</span> <span class="fu">sqrt</span>(sample_size))</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  p2[j]<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">abs</span>(t_stat)<span class="sc">&gt;</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>sample_size<span class="dv">-1</span>))</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>p1.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(p1 <span class="sc">&lt;</span> alpha)</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>p2.hat<span class="ot">&lt;-</span><span class="fu">mean</span>(p2)</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p1.hat, p2.hat))</span></code></pre></div>
<pre><code>## [1] 0.0717 0.0717</code></pre>
<p>Under the same conditions, the probability of the first type of error
in uniform distribution is the closest to 0.05, followed by exponential
distribution, and the probability of the first type of error in
Chi-square distribution is the highest, which is close to 0.1. On the
one hand, it shows the robustness of t-test mean value test, that is, it
can also get better test results for non-normal distribution. On the
other hand, it shows that the uniform distribution and exponential
distribution are more similar to the normal distribution in the case of
the question, so the test results are more inclined to the t-test test
in the case of normal distribution.</p>
</div>
</div>
</div>
<div id="hw4" class="section level2">
<h2>HW4</h2>
<div id="question-4" class="section level3">
<h3>Question</h3>
<ul>
<li><p>Ex1(see figure in the pdf in qq)</p></li>
<li><p>Ex2(see figure in the pdf in qq)</p></li>
<li><p>Ex3 Obtain a bootstrap t confidence interval estimate for the
correlation statistic in Example 7.2 (law data in bootstrap).</p></li>
</ul>
</div>
<div id="answers-4" class="section level3">
<h3>Answers</h3>
<div id="ex1-2" class="section level4">
<h4>Ex1</h4>
<p>Here consider FWER calculated by definition, the number of
experiments in which the adjusted p-value rejects the null hypothesis in
all cases where the null hypothesis holds/the total number of
experiments. Considering that FDR is calculated according to the
definition, the number of p-values that reject the null hypothesis for
the adjusted p-values that hold the null hypothesis/the number of
p-values that reject the null hypothesis for the adjusted p-values, and
the expectation is estimated by averaging all the simulated FDR values.
Considering that TDR is calculated according to the definition, the
number of p-values that reject the original hypothesis for the adjusted
p-value if the opposing hypothesis is true/the number of opposing
hypotheses is true, and the expectation is estimated by averaging all
the simulated FDR values.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span>;M<span class="ot">&lt;-</span><span class="dv">1000</span>;alpha<span class="ot">&lt;-</span><span class="fl">0.1</span>  </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>reject1_h0<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>M,<span class="at">ncol=</span>m)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>reject2_h0<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>M,<span class="at">ncol=</span>m)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>result[[<span class="dv">1</span>]]<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>M,<span class="at">ncol=</span><span class="dv">3</span>)  <span class="co">#Bonferroni</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>result[[<span class="dv">2</span>]]<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>M,<span class="at">ncol=</span><span class="dv">3</span>)  <span class="co">#B-H</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (simu <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  p_H0<span class="ot">&lt;-</span><span class="fu">runif</span>(m<span class="sc">*</span><span class="fl">0.95</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  p_Ha<span class="ot">&lt;-</span><span class="fu">rbeta</span>(m<span class="sc">*</span><span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="dv">1</span>)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">&lt;-</span><span class="fu">c</span>(p_H0,p_Ha)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  p.adj1 <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p,<span class="at">method=</span><span class="st">&#39;bonferroni&#39;</span>)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  p.adj2 <span class="ot">&lt;-</span><span class="fu">p.adjust</span>(p,<span class="at">method=</span><span class="st">&#39;fdr&#39;</span>)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#reject?</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  reject1_h0[simu,] <span class="ot">&lt;-</span> p.adj1 <span class="sc">&lt;</span> alpha</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  reject2_h0[simu,] <span class="ot">&lt;-</span> p.adj2 <span class="sc">&lt;</span> alpha</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="co">#FWER</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>fwer1<span class="ot">&lt;-</span><span class="dv">0</span>;fwer2<span class="ot">&lt;-</span><span class="dv">0</span>;fdr1<span class="ot">&lt;-</span><span class="dv">0</span>;fdr2<span class="ot">&lt;-</span><span class="dv">0</span>;tdr1<span class="ot">&lt;-</span><span class="dv">0</span>;tdr2<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (simu <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  fwer1<span class="ot">&lt;-</span>fwer1<span class="sc">+</span>(<span class="fu">sum</span>(reject1_h0[simu,(<span class="dv">1</span><span class="sc">:</span>m<span class="sc">*</span><span class="fl">0.95</span>)])<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  fwer2<span class="ot">&lt;-</span>fwer2<span class="sc">+</span>(<span class="fu">sum</span>(reject2_h0[simu,(<span class="dv">1</span><span class="sc">:</span>m<span class="sc">*</span><span class="fl">0.95</span>)])<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  fdr1<span class="ot">&lt;-</span>fdr1<span class="sc">+</span><span class="fu">sum</span>(reject1_h0[simu,(<span class="dv">1</span><span class="sc">:</span>m<span class="sc">*</span><span class="fl">0.95</span>)])<span class="sc">/</span><span class="fu">sum</span>(reject1_h0[simu,])</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>  fdr2<span class="ot">&lt;-</span>fdr2<span class="sc">+</span><span class="fu">sum</span>(reject2_h0[simu,(<span class="dv">1</span><span class="sc">:</span>m<span class="sc">*</span><span class="fl">0.95</span>)])<span class="sc">/</span><span class="fu">sum</span>(reject2_h0[simu,])</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>  tdr1<span class="ot">&lt;-</span>tdr1<span class="sc">+</span><span class="fu">sum</span>(reject1_h0[simu,(m<span class="sc">*</span><span class="fl">0.95</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m])<span class="sc">/</span>(m<span class="sc">*</span><span class="fl">0.05</span>)</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>  tdr2<span class="ot">&lt;-</span>tdr2<span class="sc">+</span><span class="fu">sum</span>(reject2_h0[simu,(m<span class="sc">*</span><span class="fl">0.95</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m])<span class="sc">/</span>(m<span class="sc">*</span><span class="fl">0.05</span>)</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>result[<span class="dv">1</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span>fwer1<span class="sc">/</span>M;result[<span class="dv">2</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span>fwer2<span class="sc">/</span>M </span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>result[<span class="dv">1</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span>fdr1<span class="sc">/</span>M;result[<span class="dv">2</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span>fdr2<span class="sc">/</span>M</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>result[<span class="dv">1</span>,<span class="dv">3</span>]<span class="ot">&lt;-</span>tdr1<span class="sc">/</span>M;result[<span class="dv">2</span>,<span class="dv">3</span>]<span class="ot">&lt;-</span>tdr2<span class="sc">/</span>M</span></code></pre></div>
<p>summary the above results:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>result<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(result)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(result)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Bonferroni&quot;</span>,<span class="st">&quot;B-H&quot;</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(result)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>,<span class="st">&quot;FDR&quot;</span>,<span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(result),<span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">FWER</th>
<th align="right">FDR</th>
<th align="right">TPR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bonferroni</td>
<td align="right">0.097</td>
<td align="right">0.0052936</td>
<td align="right">0.39720</td>
</tr>
<tr class="even">
<td align="left">B-H</td>
<td align="right">0.936</td>
<td align="right">0.1011225</td>
<td align="right">0.56456</td>
</tr>
</tbody>
</table>
</div>
<div id="ex2" class="section level4">
<h4>Ex2</h4>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>lambda_true<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>sample_num<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span>  <span class="co">#simulation numbers</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sample_num)){  </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  results[[i]]<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>,m<span class="sc">*</span><span class="dv">2</span>),<span class="at">nrow=</span>m) </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(results[[i]])<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;bias&quot;</span>,<span class="st">&quot;sd&quot;</span>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (sam <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sample_num)){   <span class="co">#1:3</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (simu <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">rexp</span>(sample_num[sam],lambda_true)  </span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    thetastar<span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    theta <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>      xstar<span class="ot">&lt;-</span><span class="fu">sample</span>(x,<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>      thetastar[b]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>    results[[sam]][simu,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">mean</span>(thetastar)<span class="sc">-</span>theta,<span class="dv">3</span>)</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>    results[[sam]][simu,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">sd</span>(thetastar),<span class="dv">3</span>)</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (sam <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sample_num)){</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;sample number is &quot;</span>,sample_num[sam],<span class="st">&quot;,result is:&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>  result<span class="ot">&lt;-</span>results[[sam]]</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;bootstrap bias mean&quot;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(result[,<span class="dv">1</span>]),<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;bootstrap sd mean&quot;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(result[,<span class="dv">2</span>]),<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## sample number is 5,result is:
## bootstrap bias mean0.616
## bootstrap sd mean3.09
## sample number is 10,result is:
## bootstrap bias mean0.214
## bootstrap sd mean0.803
## sample number is 20,result is:
## bootstrap bias mean0.104
## bootstrap sd mean0.498</code></pre>
<p>summary the above results:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3</span><span class="sc">*</span><span class="dv">4</span>),<span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(dat)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(dat)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;n=5&quot;</span>,<span class="st">&quot;n=10&quot;</span>,<span class="st">&quot;n=20&quot;</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dat)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;bias_bs&quot;</span>,<span class="st">&quot;bias_theory&quot;</span>,<span class="st">&quot;se_bs&quot;</span>,<span class="st">&quot;se_theory&quot;</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (sam <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sample_num)){</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  result<span class="ot">&lt;-</span>results[[sam]]</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  dat[sam,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">mean</span>(result[,<span class="dv">1</span>]),<span class="dv">3</span>),<span class="fu">round</span>(<span class="fu">mean</span>(result[,<span class="dv">2</span>]),<span class="dv">3</span>))   <span class="co">#mean</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  dat[sam,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">round</span>(lambda_true<span class="sc">/</span>(sample_num[sam]<span class="sc">-</span><span class="dv">1</span>),<span class="dv">3</span>),<span class="fu">round</span>(lambda_true<span class="sc">*</span>sample_num[sam]<span class="sc">/</span>(sample_num[sam]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(sample_num[sam]<span class="sc">-</span><span class="dv">2</span>),<span class="dv">3</span>))   <span class="co">#theoretical value</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(dat),<span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">bias_bs</th>
<th align="right">bias_theory</th>
<th align="right">se_bs</th>
<th align="right">se_theory</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">n=5</td>
<td align="right">0.616</td>
<td align="right">0.500</td>
<td align="right">3.090</td>
<td align="right">1.443</td>
</tr>
<tr class="even">
<td align="left">n=10</td>
<td align="right">0.214</td>
<td align="right">0.222</td>
<td align="right">0.803</td>
<td align="right">0.786</td>
</tr>
<tr class="odd">
<td align="left">n=20</td>
<td align="right">0.104</td>
<td align="right">0.105</td>
<td align="right">0.498</td>
<td align="right">0.496</td>
</tr>
</tbody>
</table>
<p>It can be seen from the table that with the increase of sample size,
the deviation of the estimator obtained by bootstrap (average value in
the sense of 1000 repetitions) and its standard deviation (average value
in the sense of 1000 repetitions) are closer and closer to the
theoretical value.</p>
</div>
<div id="ex3" class="section level4">
<h4>Ex3</h4>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#refer to the textbook</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>boot.t.ci <span class="ot">&lt;-</span><span class="cf">function</span>(x, <span class="at">B =</span> <span class="dv">500</span>, <span class="at">R =</span> <span class="dv">100</span>, <span class="at">level =</span> .<span class="dv">95</span>, statistic){</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the bootstrap t CI</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(x); n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  stat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B); se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  boot.se <span class="ot">&lt;-</span> <span class="cf">function</span>(x, R, f) {  <span class="co">#x^(b) use bootstrap</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#local function to compute the bootstrap</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#estimate of standard error for statistic f(x)</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(x); m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    th <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, <span class="at">expr =</span> {</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>      i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="at">size =</span> m, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">f</span>(x[i, ])})</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">sd</span>(th))</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) { </span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>    j <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> x[j, ]</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>    stat[b] <span class="ot">&lt;-</span> <span class="fu">statistic</span>(y)</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>    se[b] <span class="ot">&lt;-</span> <span class="fu">boot.se</span>(y, <span class="at">R =</span> R, <span class="at">f =</span> statistic)</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  stat0 <span class="ot">&lt;-</span> <span class="fu">statistic</span>(x)</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  t.stats <span class="ot">&lt;-</span> (stat <span class="sc">-</span> stat0) <span class="sc">/</span> se</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  se0 <span class="ot">&lt;-</span> <span class="fu">sd</span>(stat)</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> level</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>  Qt <span class="ot">&lt;-</span> <span class="fu">quantile</span>(t.stats, <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>), <span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(Qt) <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">names</span>(Qt))</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>  CI <span class="ot">&lt;-</span> <span class="fu">rev</span>(stat0 <span class="sc">-</span> Qt <span class="sc">*</span> se0)</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap) <span class="co">#for the law data</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(law<span class="sc">$</span>LSAT, law<span class="sc">$</span>GPA)  <span class="co">#data</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>stat <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {   </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(data[, <span class="dv">1</span>],data[, <span class="dv">2</span>])}</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.t.ci</span>(data, <span class="at">statistic =</span> stat, <span class="at">B=</span><span class="dv">2000</span>, <span class="at">R=</span><span class="dv">200</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ci)</span></code></pre></div>
<pre><code>##       2.5%      97.5% 
## -0.1746058  1.0006722</code></pre>
</div>
</div>
</div>
<div id="hw5" class="section level2">
<h2>HW5</h2>
<div id="question-5" class="section level3">
<h3>Question</h3>
<p>Exercises 7.5 7.8 7.11 (pages 212-213, Statistical Computing with
R).</p>
</div>
<div id="answers-5" class="section level3">
<h3>Answers</h3>
<div id="exercise-7.5" class="section level4">
<h4>Exercise 7.5</h4>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot) </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(graphics)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> aircondit<span class="sc">$</span>hours <span class="co">#data</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>boot.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>dat,<span class="at">statistic=</span>boot.mean, <span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ci)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = de, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 34.4, 181.4 )   ( 24.3, 170.1 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.1, 191.9 )   ( 55.6, 224.7 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(de<span class="sc">$</span>t, <span class="at">prob =</span> <span class="cn">TRUE</span>,<span class="at">main=</span><span class="st">&quot;Bootstrap replicates&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The 95% bootstrap confidence interval for the mean time between
failures calculated by the standard normal method is (34.4,181.4), the
Basic Law is (24.3,170.1), the percentile method is (46.1,191.9), and
the BCa method is (55.6,224.7), which are different from each other and
the interval length is different.</p>
<p>It can be seen from the histogram of each repeat that the density is
not approximately normal, so the normal and percentile intervals are
different. The presumed reason is that the sample is too small and CLT
cannot give a good approximation here. The BCa interval is a percentile
type interval, but it adjusts for skewness and bias, so the BCa interval
is significantly different from the other intervals.</p>
</div>
<div id="exercise-7.8" class="section level4">
<h4>Exercise 7.8</h4>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> scor;n<span class="ot">&lt;-</span><span class="fu">nrow</span>(dat)<span class="co">#data</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co">#jackknife estimate bias</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co">#theta_hat</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>cov.hat <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>evs.hat <span class="ot">&lt;-</span> <span class="fu">eigen</span>(cov.hat)<span class="sc">$</span>values</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span><span class="fu">max</span>(evs.hat)<span class="sc">/</span><span class="fu">sum</span>(evs.hat)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="co">#theta.jack</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  cov.jack <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor[<span class="sc">-</span>i,])</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  evs.jack <span class="ot">&lt;-</span> <span class="fu">eigen</span>(cov.jack)<span class="sc">$</span>values</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(evs.jack)<span class="sc">/</span><span class="fu">sum</span>(evs.jack)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="co">#bias&amp;se</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span>theta.hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta.hat,<span class="at">bias.jack=</span>bias.jack,</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="at">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
</div>
<div id="exercise-7.11" class="section level4">
<h4>Exercise 7.11</h4>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## Warning: package &#39;DAAG&#39; was built under R version 4.2.3</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models on leave-two-out samples</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>indexs<span class="ot">&lt;-</span><span class="fu">combn</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="dv">2</span>)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (ind <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(indexs)) {</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>indexs[,ind]]</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>indexs[,ind]]</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[indexs[,ind]]</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  e1[ind] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[indexs[,ind]] <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[indexs[,ind]] <span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[indexs[,ind]]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  e2[ind] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[indexs[,ind]] <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[indexs[,ind]]</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>  e3[ind] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[indexs[,ind]] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>  logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[indexs[,ind]])</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>  e4[ind] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[indexs[,ind]] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1), <span class="fu">mean</span>(e2), <span class="fu">mean</span>(e3), <span class="fu">mean</span>(e4))</span></code></pre></div>
<pre><code>## [1] 39.14455 35.74037 36.90983 40.93436</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(ironslag)</span></code></pre></div>
<p>The results show that the Quadratic model has the smallest
leave-two-out error.</p>
</div>
</div>
</div>
<div id="hw6" class="section level2">
<h2>HW6</h2>
<div id="question-6" class="section level3">
<h3>Question</h3>
<ul>
<li>Ex1 Proof the Stationarity of Metropolis-Hastings sampler Algorithm
in continuous situation.</li>
<li>Exercises 8.1 8.3 (pages 242-243, Statistical Computing with R)</li>
</ul>
</div>
<div id="answers-6" class="section level3">
<h3>Answers</h3>
<div id="ex1-3" class="section level4">
<h4>Ex1</h4>
<p>Let <span class="math inline">\(f\)</span> be the probability density
function of the target distribution, and <span class="math inline">\(Q\)</span> be a transition distribution function,
if <span class="math inline">\(Q(x,|\cdot)\)</span> has transition
density <span class="math inline">\(q(\cdot|x)\)</span>, then the
acceptance probability is calculated after extracting a sample <span class="math inline">\(y\)</span> from <span class="math inline">\(Q(x,|\cdot)\)</span> <span class="math display">\[
\alpha(x,y)=min\left\{1,\frac{f(y)q(x|y)}{f(x)q(y|x)}\right\}.
\]</span></p>
<p>For all <span class="math inline">\((x,y)\)</span>, such that <span class="math inline">\(f(x)q(y|x)&gt;0\)</span>, the resulting Markov
chain transfer kernel is <span class="math display">\[p(x,y)=q(y|x)\alpha(x,y)=q(y|x)min\left\{1,\frac{f(y)q(x|y)}{f(x)q(y|x)}\right\}\]</span>,
so <span class="math display">\[
p(x,y)f(x)=f(x)q(y|x)\alpha(x,y)=p(y,x)f(y).
\]</span> Integrating both sides of the fine balance equation, we have
<span class="math display">\[
\int p(x,y)f(x)dx=\int p(y,x)f(y)dx=f(y)
\]</span> By the definition of stationary distribution, we know that
<span class="math inline">\(f\)</span> is stationary distribution.</p>
</div>
<div id="exercise-8.1" class="section level4">
<h4>Exercise 8.1</h4>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Cramer-von Mises test</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>two_sample_cvm_test <span class="ot">&lt;-</span> <span class="cf">function</span>(X, Y,<span class="at">R=</span><span class="dv">999</span>) {</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the empirical distribution function (ECDF) and sort the sample</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  ecdf_X <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(X)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  ecdf_Y <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(Y)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  sorted_X <span class="ot">&lt;-</span> <span class="fu">sort</span>(X)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  sorted_Y <span class="ot">&lt;-</span> <span class="fu">sort</span>(Y)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the Cramer-von Mises statistic</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(X)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(Y)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  CVM_statistic <span class="ot">&lt;-</span> n<span class="sc">*</span>m<span class="sc">/</span>(m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="fu">sum</span>((<span class="fu">ecdf_X</span>(sorted_X) <span class="sc">-</span> <span class="fu">ecdf_Y</span>(sorted_X))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">sum</span>((<span class="fu">ecdf_X</span>(sorted_Y) <span class="sc">-</span> <span class="fu">ecdf_Y</span>(sorted_Y))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate p-value</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>  permuted_CVM <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) </span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>  combined_data <span class="ot">&lt;-</span> <span class="fu">c</span>(X, Y)</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  len<span class="ot">&lt;-</span>m<span class="sc">+</span>n</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(len,<span class="at">size=</span>n,<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>    permuted_X <span class="ot">&lt;-</span> combined_data[k]</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>    permuted_Y <span class="ot">&lt;-</span> combined_data[<span class="sc">-</span>k]</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>    permuted_CVM[i] <span class="ot">&lt;-</span> n<span class="sc">*</span>m<span class="sc">/</span>(m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="fu">sum</span>((<span class="fu">ecdf</span>(permuted_X)(<span class="fu">sort</span>(permuted_X)) <span class="sc">-</span> <span class="fu">ecdf</span>(permuted_Y)(<span class="fu">sort</span>(permuted_X)))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">sum</span>((<span class="fu">ecdf</span>(permuted_X)(<span class="fu">sort</span>(permuted_Y)) <span class="sc">-</span> <span class="fu">ecdf</span>(permuted_Y)(<span class="fu">sort</span>(permuted_Y)))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(CVM_statistic,permuted_CVM)<span class="sc">&gt;=</span> CVM_statistic)</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># result</span></span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">round</span>(p_value,<span class="dv">4</span>))</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a><span class="co">#load</span></span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Cramer-von Mises test</span></span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">two_sample_cvm_test</span>(x, y)</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>## [1] 0.414</code></pre>
</div>
<div id="exercise-8.3" class="section level4">
<h4>Exercise 8.3</h4>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co">#generate data</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x) <span class="co">#centered by sample mean</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a><span class="co">#permutation test</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span> <span class="co">#number of replicates</span></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) <span class="co">#pooled sample</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>len<span class="ot">&lt;-</span><span class="fu">length</span>(z)</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>tests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) <span class="co">#storage for replicates</span></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>test0 <span class="ot">&lt;-</span> <span class="fu">count5test</span>(x, y)</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#generate indices for the first sample</span></span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(len, <span class="at">size =</span> <span class="fu">length</span>(x), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>  tests[i] <span class="ot">&lt;-</span> <span class="fu">count5test</span>(x1,y1)</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(test0, tests))</span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(p,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.181</code></pre>
</div>
</div>
</div>
<div id="hw7" class="section level2">
<h2>HW7</h2>
<div id="question-7" class="section level3">
<h3>Question</h3>
<ul>
<li><p>Ex1(see figure in the pdf in qq)</p></li>
<li><p>Ex2 Exercises 9.4 9.7 9.10 (pages 277-278, Statistical Computing
with R).</p></li>
</ul>
</div>
<div id="answers-7" class="section level3">
<h3>Answers</h3>
<div id="ex1-4" class="section level4">
<h4>Ex1</h4>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(graphics)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>Na <span class="ot">&lt;-</span> <span class="fl">1e6</span>; b1a <span class="ot">&lt;-</span> <span class="dv">0</span>; b2a <span class="ot">&lt;-</span> <span class="dv">1</span>; b3a<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">1</span>;f0s <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>as<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(f0s))</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>finda<span class="ot">&lt;-</span><span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">&lt;-</span><span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  x2<span class="ot">&lt;-</span><span class="fu">rexp</span>(N,<span class="dv">1</span>)</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  x3<span class="ot">&lt;-</span><span class="fu">rbinom</span>(N,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  solution<span class="ot">&lt;-</span><span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">0</span>))</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">&lt;-</span><span class="fu">round</span>(solution<span class="sc">$</span>root,<span class="dv">5</span>)</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a)</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a><span class="co">#show results</span></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(value <span class="cf">in</span> f0s){</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;f0=&quot;</span>,value,<span class="st">&quot;root is&quot;</span>,<span class="fu">finda</span>(Na,b1a,b2a,b3a,value),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>  as[<span class="fu">which</span>(f0s<span class="sc">==</span>value)]<span class="ot">&lt;-</span><span class="fu">finda</span>(Na,b1a,b2a,b3a,value)</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## f0=0.1root is-3.1688
## f0=0.01root is-6.07389
## f0=0.001root is-8.73405
## f0=1e-04root is-11.30009</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plots</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="sc">-</span><span class="fu">log</span>(f0s),as,<span class="at">main=</span><span class="st">&quot;The scatter plot of -log(f0) and a&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;-log(f0)&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;a&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(f0s),as,<span class="at">main=</span><span class="st">&quot;The scatter plot of log(f0) and a&quot;</span>,<span class="at">xlab =</span> <span class="st">&quot;log(f0)&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;a&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The relationship between log(f0) and a is linear.</p>
</div>
<div id="exercise-9.4" class="section level4">
<h4>Exercise 9.4</h4>
<p>standard Laplace function is <span class="math inline">\(f(x)=\frac 1
2e^{-|x|}\)</span>. According to random walk M-H, the acceptance
probability is <span class="math display">\[
r(X_t,Y)=\frac{f(Y)}{f(X_t)}=\frac{e^{-|y|}}{e^{-|x_t|}}
\]</span> where <span class="math inline">\(Y=X_t+Z,Z\sim
N(0,\sigma^2)\)</span>.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(graphics)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>lap<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>rw.Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> (<span class="fu">lap</span>(y)<span class="sc">/</span><span class="fu">lap</span>(x[i<span class="dv">-1</span>]))) x[i] <span class="ot">&lt;-</span> y </span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span>   <span class="co">#reject numbers</span></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>,<span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>rw1 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>rw2 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>rw3 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>rw4 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(rw1<span class="sc">$</span>k, rw2<span class="sc">$</span>k, rw3<span class="sc">$</span>k, rw4<span class="sc">$</span>k))</span></code></pre></div>
<pre><code>## [1] 1671 2858 4780 8979</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reject prob</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(rw1<span class="sc">$</span>k, rw2<span class="sc">$</span>k, rw3<span class="sc">$</span>k, rw4<span class="sc">$</span>k)<span class="sc">/</span>N)</span></code></pre></div>
<pre><code>## [1] 0.1671 0.2858 0.4780 0.8979</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#accept prob</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>rw1<span class="sc">$</span>k<span class="sc">/</span>N,<span class="dv">1</span><span class="sc">-</span>rw2<span class="sc">$</span>k<span class="sc">/</span>N,<span class="dv">1</span><span class="sc">-</span>rw3<span class="sc">$</span>k<span class="sc">/</span>N,<span class="dv">1</span><span class="sc">-</span>rw4<span class="sc">$</span>k<span class="sc">/</span>N))</span></code></pre></div>
<pre><code>## [1] 0.8329 0.7142 0.5220 0.1021</code></pre>
<p>The second chain (<span class="math inline">\(\sigma=1\)</span>) is
more appropriate in terms of acceptance and rejection rates, with a
rejection rate of about 0.3 and an acceptance rate of about 0.7, which
can also be seen in the timing chart below.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot ts</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>rw <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rw1<span class="sc">$</span>x, rw2<span class="sc">$</span>x, rw3<span class="sc">$</span>x, rw4<span class="sc">$</span>x)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(rw[,j], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[j],<span class="dv">3</span>))),<span class="at">ylab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylim=</span><span class="fu">range</span>(rw[,j]))</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="fl">0.01</span>);burn<span class="ot">&lt;-</span><span class="dv">2000</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="fu">lap</span>(x)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(rw[,i][<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn)], <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>,<span class="at">xlab =</span> <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(sigma[i])), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, fx, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAbFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6Ojo6ZpA6ZrY6kNtmAABmADpmOgBmZrZmtttmtv+QOgCQZgCQ2/+2ZgC2Zjq22/+2/7a2///T09PbkDrbtpDb///fU2v/tmb/25D//7b//9v////olisOAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIrUlEQVR4nO2d63qjNhRFyTRJL/F0mjT0YhrZjt//HQsIO2AkbSR0OSR7/Zh8MzbHsEY6QtIJrs7ESVX6BKRDQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIEEdQdSVKuBtUiqBLiXxFFJQ3nIaCABQkmQ0IKtqAKAixCUElFVEQQLygqlIVBbki7vebE3R8fI4Zzs2WBJ12H3Oub/+uDreMTlD0oD6f7/PmQ/XU/cjbgtQ+0Rx44ed7vfu0u38rIGhfsI/5XlF990pBTprqKZ+gtnOprQlq289P+QS1GXq/NUHn95eKgqSEGwRtZhS70uS5D2rtqG0Kuo2SaNH+KqhcHxPfxSjIGW6vqk0Jagcw10wsXZLeiKBGz8Wuk7KV4TCSBLVT9Qfw3veXq5amm5O5wsVB1jDftH3H0jA0p931BvGQa5hXggSdkaMSLegiqFgfu72ixpWCm8scI1sOUoOgSpVqRJPPPbR2ntuGYmkeH2uK1jdEFzTkoL0AQd3F6wu3JRivcFG4JmkBgk67u9eI4eIgStB37WdF8zknFFRsIJsJss3TPcPFYFhOFCGo/piPO2+FFoaLQ6VnqlpQqXF+1oIihYuBLEECw1EQCrYfJ+lChvQVnXZP131lQUl6L2kUExiuUhTkDiZLUNvNuqmqdZrljJJk0X4qqGgO6qjv346PD+caLZstDBeBmxZUxtBoLvbczuafJU015AmqWzmSphqTUazQktCoiz101T+nnaAuNhFUKE9P1oPuXt9fVvn51ILkhVM3gookIcGC1G0LUiVqFT8+Eu6a+oVbz1xQiU42StKrzMzCrWcuqMQ4NhrmF6yUNf22xzlPfdBMUJENxMl9EKK5ez3r+4D0grreLkrQggFe76z222YZBE3ECBDUzzPcXBpZO2vLIEjNBakCA/24ugONYte9+fqhjKASd0J+9UGDllZmckHK1MWkC7pWL7y/fEVBbbu4f6tXbYslT9L5f/FnlKTvXptuNi9k49AsKP+MdTTMP/VlUcvWg5InaWUWlH+2MblR7AQFrSjGX5O2Cco+25i1oDpo1X4WbiXKIih/GcxtDmrg7eLCcOtQthxUUJC+VXRXUWUsJBeXpJeQs5B8i4LylQEru6Dc94o3czFnhs5XSK66tQ5LC8ps6HJF9bAQ5iowy9aC1GVDwygobycbPu1wSc6O32jOV0guT9Botcy5N5+tkNwhKHOavhZQXf5BxtazPEEw/fqEW4lyC8q7rihQkAKCqqwbiOIEdVUc1w0Ni6CceVqeoP1onmoWlPV2+iIIPjrJJ9yqE7p1IUKQoHBqiaCMaXqjgvIZkiZILRKUcSATJmhat+kQlC0NSRM0d2EUlC9Px/mcWIv2txUvDkG5spCsFuQjKJMhUYKUh6BcC2eSBHVjk0cOymNIlCCbi+0n6SjhDHuFLkFVnjYkR5Bpr9AlqOtkGQwJEdT9iry3oCrHwocUQd2esq+gwVJaRzIEKZ1UQgSlnnT4RU+0N69sa2RLBKm0jUjC3vwk/fgK2vfz/5CPXUb5vfn+/3+FoH3amyKf0En25lX/SPZ1glTC0axwC1LKucKxuAX1meicIht55qCoe/P6Ni+KoO4PVaXobH4BI+7NK6XHH+f81E+QGrqr1yUhct0HXc67/6nVLHDiJaj66GwRLWUT1DV+3V76prP8ij0F9Rk7YlcLDLS4kHxYie0af9+rlP8Vh7xd6R7cfWTYBdqvKCzKlOH0xj+rUtyeyHAqmQV9YigIEHmy+vmIPFn9fESeagxBRZNO0OIyK0dQ+0vlX1n99uUtKOSl8q+sfzuerMKg5TWkFIQnqzBoeQ1JBa0PWl4DBQW/EuPtq4OW10BBwa/EePvqoOU1SBD0maAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGAJIKOjxX8Vttb+j1Jw0r3wfZULNsBGsuj2PzPLIWgQ3tyvt+u8P7SamjmJ989luZgMmQ7YDjMvGwecGYJBOndIc+HpOjH8swO0rFMT6SxHKDpHyoa58wSCDr+HPxdd7O24tRgOkDT3P9pEhRyZgkEHb79swv8qsTZc/X1Jdn3cc0P4m+PMuagkDNLIKjpij+CvsFkvh+pW4ilndg2MLueZBQUcmYpBN25/9etHMw52i7IcEB/ArYHioacWQpB/Qk4H4ZmxNQcnF3MsgHeH2MWFHBmcQX1X8euL2d5Qhy+w934AD5XkrY9sa8ZylzmGnzPrCNBC9JVMr5dzPwQWfswbznggrEFhZxZihvFLgeMSmUWcXw0v996o2g7YMB8Jx1wZkmmGgfXJMDM0C/mKhrLVMN6gMYy1fA/M05WARQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDAVgSNq4H18x8CKthC2IigSZHHiipRf7YhaFomtO4r0DzZhqBpoVmTqXf1iBL0/tdjX/Qzq+CZlirWv/jXHwUjSlB9//f5+MNU4Dwudj3tuuKoOpMhSYKGdvJb/5d6KMXsu5OhGjhXIpIkSF/z6ft8jDJUA/uXGYchUNBufuWGauBcY70kQVrN0DQmXWwyzOs3fMUu1iaZP1oXxl9DGd8o9qK+YpI+n//7vap+NdbvDtXA+jdRamMdfRpkCRIIBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQE+B/0mditTTg8mwAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-9.7" class="section level4">
<h4>Exercise 9.7</h4>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="co">#correlation</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2) <span class="co">#initialize</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a><span class="co">#fit model</span></span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a>Xt<span class="ot">&lt;-</span>x[,<span class="dv">1</span>];Yt<span class="ot">&lt;-</span>x[,<span class="dv">2</span>]</span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yt <span class="sc">~</span> Xt)</span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Yt ~ Xt)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.44864 -0.29126  0.00505  0.28885  1.58643 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.007032   0.006896   -1.02    0.308    
## Xt           0.902807   0.007126  126.69   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4356 on 3998 degrees of freedom
## Multiple R-squared:  0.8006, Adjusted R-squared:  0.8005 
## F-statistic: 1.605e+04 on 1 and 3998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The regression coefficient obtained by fitting is 0.902807, which is
very close to the correlation coefficient 0.9. Next, we test the
normality and constant variance of the model residuals. Based on the
relationship between Y and X, theoretically there should be<br />
<span class="math display">\[
\begin{aligned}
Var(e)&amp;=Var(Y-0.9X)\\
&amp;=Var(Y)+0.81Var(X)-1.8Cov(X,Y)\\
&amp;=1+0.81-1.8*0.9*1=0.19  
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(graphics)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> lm.fit<span class="sc">$</span>residuals</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co">#test normality</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(res)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(res, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAxlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrYA/wA6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kNtmAABmADpmOgBmOjpmZgBmZjpmkGZmkJBmkLZmkNtmtrZmtttmtv+QOgCQZjqQkGaQkLaQtpCQttuQ27aQ2/+2ZgC2Zjq2ZpC2kGa225C227a22/+2/7a2///bkDrbkGbbtmbbtpDb25Db27bb29vb/7bb/9vb////tmb/25D/27b//7b//9v///+UF50RAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMkUlEQVR4nO2dCXvcNBCGtaEL6XKzS7lpwhmXo9RQCsRp1v//T6Hb0q7t0W05ne950mwdWce7o9HIlmXSo2ZFlq5A7UJAgBAQIAQECAEBQkCAEBAgBAQIAQFCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQIAQFCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQoI6CGkCv66/5ALr3PPV6T7a3+z8vPCCEfPL21UpwdbInQh89Pzpcn/PLCuxp9bkCsktGA7p/Ilj96PiQYOagAkc3NCKDXTy4qBMRMKBYQ/ag0NHHsoAZETz0H1JAqAdFKKUCsS7z1Nat1SzY/PiEXv9M/vHyfbJ72f+7IoxuehtnFhzcWINruDetIL3eE7FXeYwdbgeD1gZqQOl8X2tiA3ZUZEK29BNSqL1d93P57kF/4+6ry3UgXoZ82HB7LyLCq84MSEOOvAA2F1gno4nNaJwHobseq2fLvm/67fd7/Q/9A//cXrfhT8QfaqnduWcq9AcjooY2iMn5QAnp1oL/F+WahVXaxi99oY0VjZP34r1YPb7T64l9OhenVr9SeLg1A+i/CNPrpg+c+yCy0TkAv6Pf788FoMG+ObJMgpw2Mtvj4nWjgDCBmdmT79ywg1UWtQisFRJv3NiOg+kTHjGcKEBuaHv3w6mABUi7sE9Ze3mGF+zIPivIkoM3HKg6yCq0UkKi1owUJY7m3AQl/TA9uviCi0fTXf/ZBUV5rhwHrsKCeN+jMB40D4t/0qZMWIzqN88SY2E8fPAO0Bh8kDP9sFJu0oO3t62vbBwnEQ4wwffAc0Eih3soOiDXlLA6a9kFnTrqXdsLdy9ea0MjBc0BmoV2VcRCrUEeMSPob9ml2FHv0U6vjGCk5L/3SDKVHDo4AMgo9PrMnc65a0+WO47OPbt0OJtSaAC0iBAQIAQFCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQIAQFCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCABkD3hz1f+5X1Ntz6NABqtrd3u8u+8V+S+qClAd0frvqO0J+wVSIPVhaghi3emQbEOmH4MomVyuhil/cHtoJruotxQK1YPX9VonI1yHTSfH3xjAtigCSa9o3x5T7DPAN0t+OApjwVWYkeP84FCLCg+sMqSof+GwSIL+lu9tNpxcLAy1656/nsqhNHwyqoftzO0p+6zU3LnPQMIemo6EA2lahiQBwLUR/9AR2v97zjzAzzPtnVJtGz+ghAzLkwQHGBYqWAmGvoB98TZUGN0wA+ZWcVAuKjloDy+DEHFOWDWhISAg7jZ8DJeaXrRXrOx+prLucPH/kgFbYcfSy7OiT6FvtXmo867pxB4vqkzS5ewnx4aGjFPghISOE5i50REBfRBnRaMU9AxsMzM5cyHFLVBWhm7MhjQcdrKEiqCtDc2Jqpi81eDfHPLq9mY49cPqgDwqS6AInRa7RO3j5orx3MQ5lqyLFr4sIGjmL9LJ+QyeqnIoZ+IJNVhWdq8hMO6EFc7iAQH29AzeDyZy+YOWa3rPR155nZc7gFxakGQNbV+clEzrmlqVSm7EJq4MQnBJB6an3dPsiYfc3xCQHURJBx+MrKyNF+wq5JR3ln33LzyHDOQE3CLtrHa1FAxuAO1iPkon2KhUFLAoKDHzOxc676EzQP9cyutHzMpw/rYquerHryeePiIIfY+eQE55yD61QiO+di3cZ28wznrPUn1cfW18VcYx/rHOfM9adme9teqgVSoVoCUACe0ECxY6s7ohbXlQdkhIY+cXxYoHj33gv+E67igIaxy2+aE7a6g13yWBUgEsonxAexS4nNflVdzMTjWXLIMN/wHUXj1ogXBRTB502Ig8yZu3+xDx9QSPBjnu6dMGouFlPVIEXiibCgyId9ygAi0Xwiuljc82JFAMXjiQFU/Z1VyzkHlxcOqPY7q1ZsGF5cMKC558VSlhuaf3jsfJKRd0I1isU9CJYZUCo82eIg8OZiVkDJzKfPBahVKxsmH/fJCYiY7jk6M++EwjjYQ5mTNxCNP5V/oC5B7GNl55tQGkc7vwxYX22cfCTTtVxfpcXjD6gbXm8yPYotaEGp+fgC0rdVjZctjUg/ClTYByXH4w1Id552+9dcoAjGAlkAycErJZ9gQBVONdTY7n5T0ClXv4TGyoXKJqspYx8rX8+E2knfveu0VLHUI5mZ8MQM80H3DVO7UCvbHHyCA8XYLTnSfssZRi+dd/KE5bPLiOchTFZzmk//ACarefFkAlRuqiGdczY8mQAVm6xmG9yNIpIn7MtZkMknRX6jZQQkBPcPKjRZzW8+fRAgl/2DCkxWC3QvXox3wkr2DzLdc2xes+V4J6xi/6Dcg7tRkndCv/2DossdP7sUnggfFDhb9S539ORyfEJHsSX3DyrXvXhpyRPmzi577HxSXPKEmbMrM7gb5SVPOJ9LZN8oFPyYJfoldNs/KGW59lml8aysiy3AZ02A8l/aGC01ICHvZ5EXpb1bWHZwN8r1Tyju/LRxgZBvG5fiEzTVECF0yakGWYxPyGS1+P5Bpu8pvmVDuAUVe9rHHLvKb2kR4oP4NLXUZJUsyydilWtcrOha7sJ4ao+DbPNJWwNHVQ3ICg2X4RMCqNhz88uN7WYlvBMer1O8bAUutwo8oRftC5RbCZ/Ai/bZy60FT5APclx8N56LS6tJDc5ZV8Y/4d0ur5Mm1uAeUUYShXSxvFt01cWnPiddQWxo18c7YWYnXZX59JmctMM7DifKtdyza9WyKmKyCrwEcv4dh6Pl1jO4D8oyFwt8Q119dPqMgKB3HJ4fEWQq45NnshpiQTV2L6YAQPAmb57vOCQqdK4jdrYV4qRdNnnzeMch0WN7TaOXUligmGiTN6LeCCffCVcdnT40UEyzyZv4YYCqxRPkg7w2eZt5oE7kSCSgSvkEDfOJNnmTgKQPEh/q04IX7Yn+UOHgpVUYkBXqqJ+q5Q3obrfn89AUq1xrtRpTvoB4fMhuPifZDdj9XdyLyRcQf1qev1lj5rl5l3ccWtfFapYfID51EBdd55a/wO84dJdHL3RPmqFrK0BX+nrYHIM0F66NghMnzQtIuJ/5QDHJuyWMghMnzQaIex6+PDGhjTgVnDZpPkDd5ub+wGwn5hVIIQWnTZoPEAuBKJ+7ncNMrMhN6rCkGQF5CAEBQkCAEBCgNIDWovqnlQsLAQFCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBCgpQDxPT1dJr3ONzOdc/TTQoCO17TVc/vnK7Gn+TsXQs45emohQPIOCngBXFxacdkE3DVHXy3qg2DT8G22k7F5aVFA8C0UsfzffbOD9DdllgQ0vRZ0SMItwtkuHHL01YKAOkcf7Q7IJUdfLQfI6dv26mIZ7GcJQK0IV1qn1vg4abccfbWUBTnuEeI+zMfuOjKlxeIgx2/bOVB0ztFTCwFqxTIvh5a3jlMN9xz9hJNVQAgIEAIChIAAISBACAgQAgKEgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBACAgQAgKEgAAhIEAICBACAoSAACEgQAgIEAIClA/QsDnsH647MXdX47vEDgc7+Pa7zCTN9s+5LUisf3Kt62Q69Qex+8z8Og6V9o0EJBdSzW4CtU5AX+0IX97UqsXwnfhw/+n3bKsmcZhtqr/996DS8S2fCD9PNlZvkMr361PHdZpvaZ++0pnwv6ny+H79YcDKAGKL4OWP3CyNtYA1k+0Vog5r18EOMBpqTxoJSG8J3l280ICGNKIAlQl/ubfMWG9AFqAygPa8X+gdnMTCOr7jzN7Y2Glom7AU/k441jgJSK806wQHdtxIowrRgHTGMS+VK+aD6D+igbQRwonI1vT6sGqb6WM6QmYB2Wk4FQ3IyDj/C8HCdAJIjvsSkGxNrw9rQKorURdy8dtgQaNdzEpzAkhlLJ4EqtkHmRbUq2HItiCZzrQg/tvoYoOT3t6qPO00Yxak1IQtXywJSI+8hg+6MgbkUx/EXUc3dDE+zB+vt39zhy5cjp3GBmSP9IHjfklAYpe0hu/YrUYxPqjLw3pLeHbgeH0pDIPsh7Y1nBDbK4u97Yt+urLTSM9sjmIsY25KgQ8CFQXE4xLuL1UcJHfIl4ebkziILwFupKFxSbdCE7OZzLfCBw1p+Lh/EgcJEwteILzOyeqz1Kuhp7VOQAWFgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBACAgQAgKEgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBA/wMq3F2hQyS6bQAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#test variance stability</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>qx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="fl">0.01</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(res, <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(qx, <span class="fu">dnorm</span>(qx, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="fl">0.19</span>)), <span class="at">col =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAUVBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6kNth0E9mAABmADpmtv+QOgCQkGaQ2/+2ZgC2///T09PbkDrb////tmb/25D//7b//9v////brrB8AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHwUlEQVR4nO2d23KjOBRFSU+SmcidtGkIdvj/Dx0Epk1sSRuh28G910OqUpgDrBK6HqDqiZOq9AlIh4IAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQECCOoOoPUcJJIvIVxRdU2rp8QU1DQc6IFAQiUhCIOAgqWQvtQlDJMkRB6Piiw/UUhCM2SikKckRUTaVU9LDrj+/167qqXr4+hlblPUq4NahBULMXQe3z5+Dope/Ph7cI4VahdB1UsAj5XNHXx6Clezr2k6rQcKtQo6BqH4LOh+HO6n787ue/YeFWoaodCSpSgi7NfDFD2+qgUVVwuBWofleC8rdis6BKlZoXEt4PmgU1jSo0qpctSJebfQpq87RiYxu/S0G3URJN2i8E6SFH3ODrEH2LTW08BVnZn6CxiR+w1EB/vaC2uvQPuypLR1GUoPNBd5GdLPrPeYYa3wQ1ZabNFgdth3vHUjAmxsHqRJbB6qWXKEZQjxzlLkECBU2KrFVwO4/B8tRBN4LKzCt+u6JuHIZ+fViKx1hRjVh/8MiC9MVPF26rYLzChaN6UYLOh3EmLFa4CMwj1augEhMeV0E/Jz8BxaePLai5EVSiJ3QnyDZO9wwXgTtBVYl27HLI+joed3aFVoaLgihB1xIUKVw4ug2TJEhcOAoCiBJ0PrzNfUB7P3p9uCgYBJXoCYktQXqhh4IcqKUYEYJ0xkbrGGY5o8SftJcnqH7+PL2+9DWaNlsZLhRxgvRsWDeM5aUMNYyCCmR5fBNUD3KEDDVUJU3QcG+dD8+f54OMW0ygoKEj9HT8+gjyk15Q9hkPoc18ZROUfcZjZ4Lyz9xfjwdXTf3ChaFuxQgQVAeZuQsXhkBB1tTne06vtgy8xxZkverrT65DisQrqwIFrWngL+uFf2cJGscZCN2VLCso+3Bsmd2xphWrn44ZBM3z9ZIEraWt3ijIyen1n5KCcg/HFlc03GTPnzVu7IceZVpBOq9eoKDu6djq0Xz5hUPdVskTpLOjdFrUuvmgpInkekgqT5DuKGpBm2YU485JA0F5e0J3JajeNGt/Fy4Et6DM7dhtHdSu6C6uChcSRKagqavozqLKk0guVRAmUyL5dUFjZ4JypQHLFDSNxZw1dK5EciAob0M/X1E9Vc6tK8FMSAkqIqibK2fHQDRXIvlivl6MoMVsmXNtPksiuURBixFY6aXnqoKCsj5EPwuC1a9PuBCq5WQiBRkiUBCIgAVlHa/uUVDW1wnNguCKl0+4EFSDBeXsTAtLXhhuHwpy7t9QkHv/dYIy9hWlCVJ3Lijo2/4PKijapP1aQfn6isJKkKIgN+rehVFQvs70TgXla+llCVIU5Ob2OV4K+r5z5SEoV0svSpCyuDALylNN71hQniIkSdD9I2IuQZlqIb8rSrs27ysoiyFBa/OG51ecgvJU03LW5k0P+ABBOQz5XFHatXlT7rhbUBZDQkqQvlhvQVleueRZB6Vam6+UMbEVCcrQGfI7QLK1eWVOKsOCkt9kMvpBypLxAgWlb+vLC9LVjy1fAQtKXlNvFBQrkXy0s3gxu7+g8T5T6b4VmWROWvlQRcDrgCUEPTAUBIg8WH08Ig9WH4/IQ41LUNGkE7Q6zcoR1L6p/Jbgn68vQVs2ld8S/nM8WIVBy2tIKQgPVmHQ8hqSCgoPWl4DBW3eEuPnwUHLa6CgzVti/Dw4aHkNEgQ9EhQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAiQRFCL3mRl5vSfYamkc8Qy7nBZ3jRPmvufWQpBOvWj8zd0PhjWknQcWyzjDtrP8PvW+N3hDWeWQND4phT/zyt0phXtaaXJ/EYa4w79/IYfU4LOljNLVQd5C+qqN8NqpP1iLTtcN9sKihBB7YZKyCTo36N5g22HP1hf0e95ZmkEdZu+JWm43qkc2EqDQ5BtadP7zNLdYv5v9IwoqLN/G97zzJL1gzY0Y/FuMefSuN+ZxRW0+By7821x5p38KmnzDpeIrtto/ZlpEpSg6QQ2vIfIsIurmbcew/o+2i1nluIW0y8UXqTKrMZ05q6OouVST6/WQ284syR1kP4w8oaXChuv1zU4MAtqpwwU417+Z8bBKoCCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCCBW0PnnL50GPaefnV63pdQEI1fQQeda6pxdnRA15oZ1JQwJFvQ2f960+/E77MOCIQgW9D4npA7Fx/JYRgaEC7q8l+19eoKHddCCRQmaqbc8YxWKbEGL9+71t/9lQrag6cmToeSMRWlD8n44wgWN/SBdP3e2xN7UiBUkBQoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCPA/R3DUU0UdyDQAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="exercise-9.10" class="section level4">
<h4>Exercise 9.10</h4>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;coda&quot;</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma) {</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>)) <span class="fu">return</span> (<span class="dv">0</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>gen.chain<span class="ot">&lt;-</span><span class="cf">function</span>(sigma,N,x1){</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">&lt;-</span>x1</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    num <span class="ot">&lt;-</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, <span class="at">df =</span> y)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>    den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den) x[i] <span class="ot">&lt;-</span> y </span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">3</span>  <span class="co">#number of chains</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df=</span><span class="dv">1</span>),<span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df=</span><span class="dv">2</span>),<span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df=</span><span class="dv">3</span>))</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a><span class="co">#generate the chains</span></span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> <span class="fu">gen.chain</span>(sigma, n, x0[i])</span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.030366</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span>i, <span class="at">ylab=</span><span class="fu">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the results shown, the generated three chains can meet the
requirement of <span class="math inline">\(\hat R&lt;1.2\)</span>. The
following test is carried out with coda package, and the results are
similar.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>l1<span class="ot">&lt;-</span><span class="fu">as.mcmc</span>(X[<span class="dv">1</span>,])</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>l2<span class="ot">&lt;-</span><span class="fu">as.mcmc</span>(X[<span class="dv">2</span>,])</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>l3<span class="ot">&lt;-</span><span class="fu">as.mcmc</span>(X[<span class="dv">3</span>,])</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>l<span class="ot">&lt;-</span><span class="fu">mcmc.list</span>(l1,l2,l3)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="fu">gelman.diag</span>(l)</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]          1       1.01</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gelman.plot</span>(l)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAbFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmkJBmtrZmtv+QOgCQOjqQOmaQZgCQkGaQkNuQ2/+2ZgC225C2/7a2///bkDrb/7bb///fU2v/tmb/25D//7b//9v///+yL39UAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKBElEQVR4nO2djZaiNhiGme3qtrqt03Yr26UrKvd/j82//AgvhAQw8z7nzIhCAj6GLwESyCoySLb2BmwdCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAXwEXfen4NuxWaYIuh0zx6cf0TZpW0wqQWV2kC8sQb3cjp9/UtAg+duZggYpsgMFDXLd/9IvKHsZ4gmq7u9Zv6Dp2a1DTEELZheP2IKKnnYQBfXk0t21L0Eyjsb6uxgFgewoCGRHQSC7jyhoxNH8xxYkmojoLMcHFyQM7cZm9zEFVWX/UUYzu0tygu7vh5Dr3bgfD0G3Y4hzGAkLqsoQp5kTFuTq8FmeEo5BoddLQSC7BAVd92IHezuHWu9qhsq3M65xfIK0uuhVgIbO2OwuqwrCC/m3gwp55cubLdRikQTZUjmvtrfZxfZz3f8hat2DjApyswsRHNTvKybevtldLM/U3NtRLtvaMdYuQfEFiWJSyCaJPDteqKuZYvtz8abMjKBcHDfKObejXLZVrNaOQRcfRxOuYykd5t/pdpRbLoq+vqKZa0G3r2d9lVzNbl/sTL0WU9/X/tNBR06o8FCrxUq5a6k37Xpt/XbQkoJMITsVDUEiHn36vg8mSJXIKlSQrpYvQZXddiPILRJYUN8lwWnZecWgCTQEuS+vA02hBSlbZahdLH9Ew1mnhZarxWqCdBWVm7rK1mK68IivE7gEedGpbJYVpNpBquTX20Fy+myqtM0F6Y0fqvoJykUTsZy3hy0Wg2bjIShXTejbEVy3GL3e1ASFPRar0hPkjsUoqGdBfRSmjm/mrzfFGBT0WGzbdqrVq/kF/BT6x3THYepDfWlmp35sWefc3/vOTSQvqNGh3VW91y96BxABVXUjKHurZA9B9sJYiCB9qSJL0qeA7Mk9V7HYKliKEjPvf/YGDL92ULGbO8xgqVpMH8Cbw/hHxVLUSpIQ1F+AvNpBh6oUv0igk/bLCNKhJ3eFPv9NH22rXewwUIA8G4rXX3+oP39mCbpIBl5rmBMbSpDe3arKDkbKDyZIDxQgz4aiPKIPIih6DDJBWglqX+axgUgUIBFX5/Z4rzUURVZCfpBdbIFqPhfVyb/qFE3e2mIbRkUByneduQavo/ld1W9cU9gWBxiKsFA7UZX2xx5mP9V1vSpAh75jyzjtIH2VSe7Z2xBUtMY/6kmjpNxV4QSJCD3ijKI+nr2/y7oOC4rcDtq16nqFvFaogrQqQFW4XUyoHiHInhGRLSYc++KWItms1WbMpugOuLk76lBNonBBuoBdxKtaP898t7qgucQ5aW+1jPthNm0o0sGqvXLf2+VeZ3ep/d8o6x7Nb1qNhoIAsQUNB+kkBd3+0a/3vzyOxVpXVpOMQabFXgbqSF4lJ0hdVBX196zrhkkLUue/547XSFrQ7AvzVeqC0HC5SWNWN87kg9Uxx2KTxqxunEjtoAljVjdOrIbi6DGrVXox6P4eckBdlZ6gfG4V315vYoI6575nrzc5QUFHPVfJCYIVVNj1ro3XsViAIpSwoMDDwrfO2h3JJYnFoNDrzShoOLu0BMkrq4FjUFqCwq83S05Q4PsHjb+b7Dqs3pJOT1Dg+wdlG28Srd5QFIISi0GB10tBzVzaY1bFa3KCgp5RzLbeEFr7jGKCgsKeUcy2fmC/djsoQUFBzyhmUzZhFTxiUJDHiTQEJRSDgj33KVVBoderXjbdEKIggIcgWc8XWTZrNFTSgvLPP6/7nR4PMnO99f8bxa8dJC+Nhbh3R7KCcnNfwrnrTVKQ2LfkmNhwt8dJLgaJttDbeW57er6ghaxG64IHGpMBSpBJFfmW5nEEFbafcG+H4SeCJn9RPVR+aqqJRBFUuzLUN3i8kV2mh656GYpNFEG1MyJ9jYHs2ZuL+wdZLK5vowQ1Zo3R1J795KYUgYgVg0wRGhWD2nlf4H27emWElxSpFrOnRXoP2J4IelKOulzASHt7m5OR24lZ/bqYepOpv8ZV6MZXvHSr9P57bLeX9OGRfBOCKuum/q3r97sR73S5MDpaUtqq1ETzhjmTytXl8sgstiD/56y2ikh2sdv8vMjUE7VSS732VU1dwGt9BatdWX0ZlhUUK7t4UBCAggCrCXoZYggaffUMZIrWOS/5zNxnLY7HrI7KNF1BYy/gf1xBI4cEfWBBQTKlIAqalykFUdC8TCkoJSgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBAgvKDS5zF3+uEOLml3oh/3MBSv1JDgguRjLtpP28GJVI8jl7Q70Y9+evHJMzUmtCDdTW/igI/bUQpySbsTQ+vb9SXy2pQOoQWZ51pNG89QfP5bCHJJuxP9SZ0gr9QjCC5IPXlo2ogYkUbGIJe0OzGQ2O5ifqkxoQV1n7cDkbuCes60TdqdGFyjeVymX2rIBgTJLsX+guQIJfmQw1cRNL1cqxTeu9gj4rzILjY9MtrnLp28wqwrJq8SpD3r1ty3mnfPXHuVat6zdZZ7NxRtDHqVhqJ7CPM09KGGS9qdGEiaZXpghFdqCA9WARQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCBAVEFPn9VRnh7zyv77OIhZvY/66JvR+TzAw0IWF1T/bGD7vb5amIenNKEgQHxBuekJf93rbmTmNpVinpkudP+V29dv8q5EenE16z/1fUsz+/jH0XSpV/nW3+tuajvx2e97/ZlZaXfByUQXJHt4ya66qitYmZ3sr6y3/WRnHip5P/TKLe5myy6+8jbpt6P4tNDdffTMx3uT4uA+a+ZSW3A6sQXdvp51PznbmbItSD+VSsxVE25xO1v3oyvfzmq2ebyOS+feHyr3Kj5r5XKY81yeJWJQmalSoA21Bek+cvJb2QBiFtd/+pvZ2WYZV7zMe/v16581cpkRnaILEtHh03f5BdTt3k9dQbaTq55hF28KkkVxSNCXs8uzsdIXEKS+oCvgudxVnpUg80HlFp9Vgjq5bFiQCj3uxl62JFT1GPSYZ7p9l9nTGNQv6BGDTs2VvoAg/TtmB9cxt/5l1LSqYGzRcovLWa1arF+QyuP+vquXIJPL5gXprri5GpKjO+Xmrh1kpgt9W0YXg/TieacdNCDItYNOzZVuXVAKUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgP8B9m3xQl+56CwAAAAASUVORK5CYII=" /><!-- --></p>
</div>
</div>
</div>
<div id="hw8" class="section level2">
<h2>HW8</h2>
<div id="question-8" class="section level3">
<h3>Question</h3>
<ul>
<li><p>Ex1(see figure in the pdf in qq)</p></li>
<li><p>Ex2 Exercises 11.8 (pages 354, Statistical Computing with
R).</p></li>
</ul>
</div>
<div id="answers-8" class="section level3">
<h3>Answers</h3>
<div id="ex1-5" class="section level4">
<h4>Ex1</h4>
<ol style="list-style-type: decimal">
<li>find MLE and prove consistency<br />
(1.1) observed MLE<br />
From the question, we have<br />
<span class="math display">\[
\begin{aligned}
L_o\left(\lambda;u,v\right)&amp;=\prod_{i=1}^{n}{P_\lambda\left(u_i\le
x_i\le v_i\right)}=\prod_{i=1}^{n}{(e^{-\lambda u_i}-e^{-\lambda
v_i})}\\
l_o\left(\lambda;u,v\right)&amp;=\sum_{i=1}^{n}log\left(e^{-\lambda
u_i}-e^{-\lambda v_i}\right)\\
\frac{\partial
l_o\left(\lambda;u,v\right)}{\partial\lambda}&amp;=\sum_{i=1}^{n}\frac{v_ie^{-\lambda
v_i}-u_ie^{-\lambda u_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}
\end{aligned}
\]</span> Set the first derivative to 0 to get the residence point <span class="math inline">\(\hat{\lambda}_{MLE,o}\)</span>, and then calculate
the second derivative</li>
</ol>
<p><span class="math display">\[\begin{equation*}\small
\begin{aligned}
\frac{\partial^2l_o\left(\lambda;u,v\right)}{\partial\lambda^2}&amp;=\sum_{i=1}^{n}
\frac{\left(-v_i^2e^{-\lambda v_i}+u_i^2e^{-\lambda
u_i}\right)\left(e^{-\lambda u_i}-e^{-\lambda
v_i}\right)-\left(v_ie^{-\lambda v_i}-u_ie^{-\lambda
u_i}\right)\left(-u_i e^{-\lambda u_i}+v_i e^{-\lambda
v_i}\right)}{\left(e^{-\lambda u_i}-e^{-\lambda v_i}\right)^2} \\
&amp;=\sum_{i=1}^{n}\frac{-\left(u_i-v_i\right)^2e^{-\lambda\left(u_i+v_i\right)}}{\left(e^{-\lambda
u_i}-e^{-\lambda v_i}\right)^2}&lt;0
\end{aligned}
\end{equation*}\]</span></p>
<p>Thus <span class="math inline">\(\hat{\lambda}_{MLE,o}\)</span> is
the extreme point, which is MLE.</p>
<p>(1.2) EM algorithm MLE</p>
<p><span class="math display">\[\begin{equation*}\small
\begin{aligned}
L_c\left(\lambda;x\right)&amp;=\prod_{i=1}^{n}{\lambda e^{-\lambda
x_i}}=\lambda^ne^{-\lambda\sum_{i=1}^{n} x_i}\\
l_c\left(\lambda;x\right)&amp;=nlog\lambda-\lambda\sum_{i=1}^{n}x_i\\
E_{\lambda^{(0)}}\left[l_c\left(\lambda;x\right)\middle|x_i\in\left[u_i,v_i\right]\right]&amp;=E_{\lambda^{(0)}}\left[nlog\lambda-\lambda\sum_{i=1}^{n}x_i\middle|x_i\in\left[u_i,v_i\right]\right]    \\
&amp;=nlog\lambda-\lambda
E_{\lambda^{(0)}}\left[\sum_{i=1}^{n}x_i\middle|x_i\in\left[u_i,v_i\right]\right]
\end{aligned}
\end{equation*}\]</span> where <span class="math inline">\(\lambda^{(0)}\)</span> represents the initial
value in each loop. Take the derivative of the left-hand side and set it
to 0.<br />
<span class="math display">\[
\begin{aligned}
\frac{n}{\lambda^{(k)}}&amp;=E_{\lambda^{(k-1)}}\left[\sum_{i=1}^{n}x_i\middle|x_i\in\left[u_i,v_i\right]\right]\\
&amp;=\left[\sum_{i=1}^{n}{\frac{1}{e^{-\lambda u_i}-e^{-\lambda
v_i}}\int_{u_i}^{v_i}{\lambda x e^{-\lambda
x}dx}}\right]_{\lambda=\lambda^{(k-1)}}\\
&amp;=\left[-\sum_{i=1}^{n}\frac{v_ie^{-\lambda v_i}-u_ie^{-\lambda
u_i}}{e^{-\lambda u_i}-e^{-\lambda
v_i}}+\frac{1}{\lambda}\sum_{i=1}^{n}\frac{e^{-\lambda u_i}-e^{-\lambda
v_i}}{e^{-\lambda u_i}-e^{-\lambda
v_i}}\right]_{\lambda=\lambda^{(k-1)}}\\
&amp;=-\frac{\partial
l\left(\lambda;u,v\right)}{\partial\lambda}\bigg|_{\lambda=\lambda^{(k-1)}}+\frac{n}{\lambda^{(k-1)}}
\end{aligned}
\]</span></p>
<p>The iteration is then repeated until convergence, which is denoted as
<span class="math inline">\(\hat{\lambda}_{MLE,EM}\)</span>.</p>
<p>(1.3) Prove the consistency</p>
<p>Rewrite the above equation as<br />
<span class="math display">\[
\frac{1}{\lambda^{(k)}}=-\frac{1}{n}\frac{\partial
l\left(\lambda;u,v\right)}{\partial\lambda}\bigg|_{\lambda=\lambda^{(k-1)}}+\frac{1}{\lambda^{(k-1)}}
\]</span></p>
<p>Define <span class="math inline">\(y_k=\frac{1}{\lambda^{(k)}}\)</span>, then we have
<span class="math inline">\(y_k=y_{k-1}+\frac{1}{n}\sum_{i=1}^{n}\frac{u_ie^{-u_i/y_{k-1}}-v_ie^{-v_i/y_{k-1}}}{e^{-
u_i/y_{k-1}}-e^{- v_i/y_{k-1}}}\)</span>, now we prove <span class="math inline">\(\left\{y_k\right\}\)</span> converges to the fixed
point of <span class="math inline">\(f(y)=y+\frac{1}{n}\sum_{i=1}^{n}\frac{u_ie^{-u_i/y}-v_ie^{-v_i/y}}{e^{-
u_i/y}-e^{- v_i/y}}\)</span>, then the estimator by EM algorithm <span class="math inline">\(\hat{\lambda}_{MLE,EM}\)</span> converges to <span class="math inline">\(\hat{\lambda}_{MLE,o}\)</span> (It is then found
that the first derivative of the observed likelihood is 0, i.e. the
fixed point is <span class="math inline">\(\hat{\lambda}_{MLE,o}\)</span>). Use the fixed
point lemma, we only need to prove <span class="math inline">\(|f^{\prime}(y)|\leq a&lt;1\)</span>.</p>
<p>Define <span class="math inline">\(g(y)=\frac{ue^{-u/y}-ve^{-v/y}}{e^{- u/y}-e^{-
v/y}}\)</span>, we only need to prove <span class="math inline">\(-1\leq
g^{\prime}(y)&lt;b(u,v)&lt;0\)</span>. Take the derivation to get<br />
<span class="math display">\[
g^{\prime}(y)=\frac{-\left(\frac{u-v}{y}\right)^2e^{-\frac{u+v}{y}}}{\left(e^{-
u/y}-e^{- v/y}\right)^2}
\]</span><br />
Obviously we have <span class="math inline">\(g^{\prime}(y)&lt;0\)</span>, and due to when <span class="math inline">\(y\in [y_1,y_2]\)</span>, <span class="math inline">\(g^{\prime}(y)\)</span> is bounded, take the upper
bound for <span class="math inline">\(i=1,\dots,n\)</span> to get <span class="math inline">\(g^{\prime}(y)&lt;b(u,v)\)</span> uniformly.</p>
<p>Another side is to prove <span class="math inline">\(\left(\frac{u-v}{y}\right)^2e^{-\frac{u+v}{y}}
\leq \left(e^{- u/y}-e^{- v/y}\right)^2\)</span>. Define <span class="math inline">\(m=-u/y,n=-v/y\)</span>, we need to prove <span class="math inline">\((e^m-e^n)^2 \geq (m-n)^2e^{m+n}\)</span>,
i.e. <span class="math inline">\(e^{m-n}+e^{n-m}-2 \geq
(m-n)^2\)</span>. Then we take <span class="math inline">\(t=m-n\)</span>, and prove <span class="math inline">\(e^t+e^{-t} \geq 2+t^2\)</span>, which is achieved
by Taylor expansion <span class="math inline">\([1+t+t^2/2+t^3/3!+\cdots]+[1-t+t^2/2-t^3/3!+\cdots]=2+t^2+t^4/4!+\cdots
\geq 2+t^2\)</span>.</p>
<p>In a word, we have <span class="math inline">\(-1\leq
g^{\prime}(y)&lt;0\)</span>, which means <span class="math inline">\(|f^{\prime}(y)|\leq a&lt;1\)</span>, where <span class="math inline">\(a\)</span> is decided by <span class="math inline">\(u_i,v_i,\lambda\)</span>. Then we have <span class="math inline">\(y_k=\frac{1}{\lambda^{(k)}}\rightarrow
\frac{1}{\lambda^{(\infty)}}=y_{\infty}\)</span>, and<br />
<span class="math display">\[
\begin{aligned}
lim_{k \rightarrow
\infty}\frac{|\lambda^{(k+1)}-\lambda^{(\infty)}|}{|\lambda^{(k)}-\lambda^{(\infty)}|}&amp;=lim_{k
\rightarrow
\infty}\frac{|1/y_{k+1}-1/y_{\infty}|}{|1/y_{k}-1/y_{\infty}|}\\
&amp;=lim_{k \rightarrow \infty}\frac{|y_k|}{|y_{k+1}|}
\frac{|1-y_{k+1}/y_{\infty}|}{|1-y_{k}/y_{\infty}|}\\
&amp;=\alpha \in (0,\infty)
\end{aligned}
\]</span> The convergence and linear convergence rate of EM algorithm
are obtained.</p>
<ol start="2" style="list-style-type: decimal">
<li>Code</li>
</ol>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>v<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>l1<span class="ot">&lt;-</span><span class="cf">function</span>(lambda){</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v)<span class="sc">-</span>u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v)))</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="co">#observe MLE</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>mle_o<span class="ot">&lt;-</span><span class="fu">uniroot</span>(l1,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">extendInt =</span> <span class="st">&quot;yes&quot;</span>)<span class="sc">$</span>root</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="co">#EM</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>lambda0<span class="ot">&lt;-</span><span class="fl">0.005</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fl">1e5</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>tol<span class="ot">&lt;-</span><span class="fl">1e-4</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>  lambda1<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">/</span>lambda0<span class="dv">-1</span><span class="sc">/</span><span class="fu">length</span>(u)<span class="sc">*</span><span class="fu">l1</span>(lambda0))</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>((<span class="fu">abs</span>(lambda1<span class="sc">-</span>lambda0)<span class="sc">/</span>lambda0)<span class="sc">&lt;=</span>tol) <span class="cf">break</span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>  lambda0<span class="ot">&lt;-</span>lambda1</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>mle_EM<span class="ot">&lt;-</span>lambda1</span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>mle_o</span></code></pre></div>
<pre><code>## [1] 0.07196174</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>mle_EM</span></code></pre></div>
<pre><code>## [1] 0.0719735</code></pre>
<p>Here the result obtained by the EM algorithm has a certain
relationship with the initial value selection, but the setting between
0.005-0.05 is close to the MLE obtained by the observation
likelihood.</p>
</div>
<div id="exercise-11.8" class="section level4">
<h4>Exercise 11.8</h4>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot) <span class="co">#needed for simplex function</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>solve.game <span class="ot">&lt;-</span> <span class="cf">function</span>(A) {</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="co">#solve the two player zero-sum game by simplex method</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co">#optimize for player 1, then player 2</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="co">#maximize v subject to ...</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="co">#let x strategies 1:m, and put v as extra variable</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="co">#A1, the &lt;= constraints</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>min.A <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> A <span class="sc">-</span> min.A <span class="co">#so that v &gt;= 0</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>max.A <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> A <span class="sc">/</span> <span class="fu">max</span>(A)</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n)) <span class="co">#constraints &lt;=</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>))) <span class="co">#constraints sum(x)=1</span></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a><span class="at">maxi=</span><span class="cn">TRUE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a><span class="co">#the ’solution’ is [x1,x2,...,xm | value of game]</span></span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a><span class="co">#minimize v subject to ...</span></span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a><span class="co">#let y strategies 1:n, with v as extra variable</span></span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m)) <span class="co">#constraints &lt;=</span></span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>))) <span class="co">#constraints sum(y)=1</span></span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb98-31"><a href="#cb98-31" aria-hidden="true" tabindex="-1"></a>sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb98-32"><a href="#cb98-32" aria-hidden="true" tabindex="-1"></a><span class="at">maxi=</span><span class="cn">FALSE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb98-33"><a href="#cb98-33" aria-hidden="true" tabindex="-1"></a>soln <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;A&quot;</span> <span class="ot">=</span> A <span class="sc">*</span> max.A <span class="sc">+</span> min.A,</span>
<span id="cb98-34"><a href="#cb98-34" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;x&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],</span>
<span id="cb98-35"><a href="#cb98-35" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;y&quot;</span> <span class="ot">=</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n],</span>
<span id="cb98-36"><a href="#cb98-36" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;v&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[m<span class="sc">+</span><span class="dv">1</span>] <span class="sc">*</span> max.A <span class="sc">+</span> min.A)</span>
<span id="cb98-37"><a href="#cb98-37" aria-hidden="true" tabindex="-1"></a>soln</span>
<span id="cb98-38"><a href="#cb98-38" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#enter the payoff matrix</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span>A<span class="sc">+</span><span class="dv">2</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>sA <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(A)</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>sB<span class="ot">&lt;-</span><span class="fu">solve.game</span>(B)</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(sA<span class="sc">$</span>x, sA<span class="sc">$</span>y), <span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(sB<span class="sc">$</span>x, sB<span class="sc">$</span>y), <span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<p>The solution for both A and B is (11.15).</p>
</div>
</div>
</div>
<div id="hw9" class="section level2">
<h2>HW9</h2>
<div id="question-9" class="section level3">
<h3>Question</h3>
<ul>
<li><p>Ex1</p>
<ul>
<li><p>2.1.3 Exercise 4 (Pages 19 Advanced in R)</p></li>
<li><p>2.3.1 Exercise 1, 2 (Pages 26 Advanced in R)</p></li>
<li><p>2.4.5 Exercise 2, 3 (Pages 30 Advanced in R)</p></li>
<li><p>Exercises 2 (page 204, Advanced R)</p></li>
<li><p>Exercises 1 (page 213, Advanced R)</p></li>
</ul></li>
<li><p>Ex2<br />
Consider Exercise 9.8 (pages 278, Statistical Computing with R). (Hint:
Refer to the first example of Case studies section)</p>
<ul>
<li><p>Write an R function.</p></li>
<li><p>Write an Rcpp function.</p></li>
<li><p>Compare the computation time of the two functions with the
function “microbenchmark”.</p></li>
</ul></li>
</ul>
</div>
<div id="answers-9" class="section level3">
<h3>Answers</h3>
<div id="ex4" class="section level4">
<h4>2.1.3 Ex4</h4>
<p><em>unlist</em> can convert a list into an atomic vector, and can
unpack the nested structure of a list into a narrow vector - an atomic
vector. Atomic vectors contain only one type element and are often more
efficient than lists when manipulating data.</p>
<p>as.vector converts a data structure into a vector, and a list is a
generalized vector, so the structure is not changed, that is, it does
not work. Here is an example.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>my_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">as.vector</span>(my_list)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="fu">unlist</span>(my_list)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(a);<span class="fu">typeof</span>(b)</span></code></pre></div>
<pre><code>## [1] &quot;list&quot;</code></pre>
<pre><code>## [1] &quot;double&quot;</code></pre>
</div>
<div id="ex12" class="section level4">
<h4>2.3.1 Ex1,2</h4>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(b)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>Return NULL.</p>
<p>If is.matrix(x) is TRUE, what will is.array(x) return?</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="at">nrow=</span><span class="dv">2</span>);<span class="fu">is.matrix</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.array</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Return TRUE.</p>
</div>
<div id="ex23" class="section level4">
<h4>2.4.5 EX2,3</h4>
<p>What does as.matrix() do when applied to a data frame with columns of
different types?</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">y =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>),<span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(df)</span></code></pre></div>
<pre><code>##      x   y  
## [1,] &quot;1&quot; &quot;a&quot;
## [2,] &quot;2&quot; &quot;b&quot;
## [3,] &quot;3&quot; &quot;c&quot;</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">y =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span>),<span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(df)</span></code></pre></div>
<pre><code>##      x y
## [1,] 1 1
## [2,] 2 0
## [3,] 3 1</code></pre>
<p>When a non-numeric/logical variable type is returned, a character
matrix is usually converted to the same type according to the cast rule,
the conversion priority relationship is as follows (arrow indicates the
conversion direction): [logical -&gt; integer -&gt; double -&gt;
character].</p>
<p>Can you have a data frame with 0 rows? What about 0 columns?</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a=</span><span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">0</span>,<span class="at">ncol=</span><span class="dv">1</span>),<span class="at">b=</span><span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">0</span>,<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## [1] a b
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df)</span></code></pre></div>
<pre><code>## [1] 0 2</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a=</span><span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">0</span>))</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## data frame with 0 columns and 2 rows</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(df)</span></code></pre></div>
<pre><code>## [1] 2 0</code></pre>
</div>
<div id="ex2-p204" class="section level4">
<h4>EX2 P204</h4>
<p>The function below scales a vector so it falls in the range [0,1].
How would you apply it to every column of a data frame?How would you
apply it to every numeric column in a dataframe?</p>
<p>Standardize all columns:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>))</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##   x y
## 1 1 4
## 2 2 4
## 3 3 5</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">lapply</span>(df,scale01))</span></code></pre></div>
<pre><code>##     x y
## 1 0.0 0
## 2 0.5 0
## 3 1.0 1</code></pre>
<p>Standardize some columns:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>z<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##   x y z
## 1 1 4 A
## 2 2 4 B
## 3 3 5 C</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>spe_scale<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.numeric</span>(x)) <span class="fu">scale01</span>(x)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> x</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">lapply</span>(df,spe_scale))</span></code></pre></div>
<pre><code>##     x y z
## 1 0.0 0 A
## 2 0.5 0 B
## 3 1.0 1 C</code></pre>
</div>
<div id="ex1-p213" class="section level4">
<h4>EX1 P213</h4>
<p>Use vapply() to:<br />
a) Compute the standard deviation of every column in a numeric data
frame.<br />
b) Compute the standard deviation of every numeric column in a mixed
data frame. (Hint: you’ll need to use vapply() twice.)</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>))</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##   x y
## 1 1 4
## 2 2 4
## 3 3 5</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(df,sd,<span class="at">FUN.VALUE =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##         x         y 
## 1.0000000 0.5773503</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>))</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>z<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>)</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##   x y z
## 1 1 4 A
## 2 2 4 B
## 3 3 5 C</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(df[<span class="fu">vapply</span>(df,is.numeric,<span class="cn">TRUE</span>)],sd,<span class="dv">1</span>)</span></code></pre></div>
<pre><code>##         x         y 
## 1.0000000 0.5773503</code></pre>
</div>
<div id="ex2-1" class="section level4">
<h4>Ex2</h4>
<p>Gibbs sampling process: First given y, extracting <span class="math inline">\(x|y=y_{i-1} \sim bin(n,y)\)</span>, then
extracting <span class="math inline">\(y|x=x_{i} \sim
beta(x+a,n-x+b)\)</span>.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(finalwork)</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.2.3</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(graphics)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b,n,initial,N) {</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># a,b,n: fixed</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># initial: intial value</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># N: length of chain</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>  mat<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> N, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>  mat[<span class="dv">1</span>,]<span class="ot">&lt;-</span>initial</span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> mat[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a>    mat[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n,y)</span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span>mat[i,<span class="dv">1</span>]</span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a>    mat[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,(x<span class="sc">+</span>a),(n<span class="sc">-</span>x<span class="sc">+</span>b))</span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (mat)</span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(Rcpp)</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="co"># generate chains</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>N_0 <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>a_0<span class="ot">&lt;-</span><span class="dv">3</span>;b_0<span class="ot">&lt;-</span><span class="dv">4</span>;n_0<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>init<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>n_0,<span class="dv">1</span>),<span class="fu">runif</span>(<span class="dv">1</span>))</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>matR <span class="ot">&lt;-</span> <span class="fu">gibbsR</span>(a_0,b_0,n_0,init,N_0)</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>XR <span class="ot">&lt;-</span> matR[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn),<span class="dv">1</span>]; YR <span class="ot">&lt;-</span> matR[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn),<span class="dv">2</span>]</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a><span class="co">#sourceCpp(&#39;gibbsC.cpp&#39;)</span></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>matC <span class="ot">&lt;-</span> <span class="fu">gibbsC</span>(a_0,b_0,n_0,init,N_0)</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>XC <span class="ot">&lt;-</span> matC[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn),<span class="dv">1</span>]; YC <span class="ot">&lt;-</span> matC[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn),<span class="dv">2</span>]</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(XR, XC, <span class="at">plot.it =</span> <span class="cn">TRUE</span>)</span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(YR, YC, <span class="at">plot.it =</span> <span class="cn">TRUE</span>)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It can be seen from the qq plots that the samples generated by the
two methods are basically the same. Next, we compare the calculation
time of the two functions.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbsR =</span> <span class="fu">gibbsR</span>(a_0,b_0,n_0,init,N_0),</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">gibbsC =</span> <span class="fu">gibbsC</span>(a_0,b_0,n_0,init,N_0))</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##     expr        lq    median        uq
## 1 gibbsR 48.673551 53.778052 58.335251
## 2 gibbsC  7.163602  7.333901  7.703151</code></pre>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
